(function(d,b){var f,c;typeof exports!=b+""?f=exports:(c=d.L,f={},f.noConflict=function(){return d.L=c,this},d.L=f),f.version="0.4.5",f.Util={extend:function(l){var h=Array.prototype.slice.call(arguments,1);for(var m=0,k=h.length,g;m<k;m++){g=h[m]||{};for(var j in g){g.hasOwnProperty(j)&&(l[j]=g[j])}}return l},bind:function(h,g){var j=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return h.apply(g,j||arguments)}},stamp:function(){var h=0,g="_leaflet_id";return function(e){return e[g]=e[g]||++h,e[g]}}(),limitExecByInterval:function(l,h,m){var k,g;return function j(){var e=arguments;if(k){g=!0;return}k=!0,setTimeout(function(){k=!1,g&&(j.apply(m,e),g=!1)},h),l.apply(m,e)}},falseFn:function(){return !1},formatNum:function(h,g){var j=Math.pow(10,g||5);return Math.round(h*j)/j},splitWords:function(g){return g.replace(/^\s+|\s+$/g,"").split(/\s+/)},setOptions:function(h,g){return h.options=f.Util.extend({},h.options,g),h.options},getParamString:function(h){var g=[];for(var j in h){h.hasOwnProperty(j)&&g.push(j+"="+h[j])}return"?"+g.join("&")},template:function(h,g){return h.replace(/\{ *([\w_]+) *\}/g,function(k,l){var j=g[l];if(!g.hasOwnProperty(l)){throw Error("No value provided for variable "+k)}return j})},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function g(l){var o,m,k=["webkit","moz","o","ms"];for(o=0;o<k.length&&!m;o++){m=d[k[o]+l]}return m}function j(k){return d.setTimeout(k,1000/60)}var e=d.requestAnimationFrame||g("RequestAnimationFrame")||j,h=d.cancelAnimationFrame||g("CancelAnimationFrame")||g("CancelRequestAnimationFrame")||function(k){d.clearTimeout(k)};f.Util.requestAnimFrame=function(l,m,n,k){l=f.Util.bind(l,m);if(!n||e!==j){return e.call(d,l,k)}l()},f.Util.cancelAnimFrame=function(k){k&&h.call(d,k)}}(),f.Class=function(){},f.Class.extend=function(l){var h=function(){this.initialize&&this.initialize.apply(this,arguments)},k=function(){};k.prototype=this.prototype;var g=new k;g.constructor=h,h.prototype=g;for(var j in this){this.hasOwnProperty(j)&&j!=="prototype"&&(h[j]=this[j])}return l.statics&&(f.Util.extend(h,l.statics),delete l.statics),l.includes&&(f.Util.extend.apply(null,[g].concat(l.includes)),delete l.includes),l.options&&g.options&&(l.options=f.Util.extend({},g.options,l.options)),f.Util.extend(g,l),h},f.Class.include=function(g){f.Util.extend(this.prototype,g)},f.Class.mergeOptions=function(g){f.Util.extend(this.prototype.options,g)};var a="_leaflet_events";f.Mixin={},f.Mixin.Events={addEventListener:function(m,j,l){var k=this[a]=this[a]||{},n,h,g;if(typeof m=="object"){for(n in m){m.hasOwnProperty(n)&&this.addEventListener(n,m[n],j)}return this}m=f.Util.splitWords(m);for(h=0,g=m.length;h<g;h++){k[m[h]]=k[m[h]]||[],k[m[h]].push({action:j,context:l||this})}return this},hasEventListeners:function(g){return a in this&&g in this[a]&&this[a][g].length>0},removeEventListener:function(m,q,g){var v=this[a],h,p,n,k,j;if(typeof m=="object"){for(h in m){m.hasOwnProperty(h)&&this.removeEventListener(h,m[h],q)}return this}m=f.Util.splitWords(m);for(p=0,n=m.length;p<n;p++){if(this.hasEventListeners(m[p])){k=v[m[p]];for(j=k.length-1;j>=0;j--){(!q||k[j].action===q)&&(!g||k[j].context===g)&&k.splice(j,1)}}}return this},fireEvent:function(l,h){if(!this.hasEventListeners(l)){return this}var k=f.Util.extend({type:l,target:this},h),j=this[a][l].slice();for(var m=0,g=j.length;m<g;m++){j[m].action.call(j[m].context||this,k)}return this}},f.Mixin.Events.on=f.Mixin.Events.addEventListener,f.Mixin.Events.off=f.Mixin.Events.removeEventListener,f.Mixin.Events.fire=f.Mixin.Events.fireEvent,function(){var e=navigator.userAgent.toLowerCase(),t=!!d.ActiveXObject,H=t&&!d.XMLHttpRequest,k=e.indexOf("webkit")!==-1,G=e.indexOf("gecko")!==-1,E=e.indexOf("chrome")!==-1,z=d.opera,q=e.indexOf("android")!==-1,B=e.search("android [23]")!==-1,w=typeof orientation!=b+""?!0:!1,j=document.documentElement,A=t&&"transition" in j.style,F=k&&"WebKitCSSMatrix" in d&&"m11" in new d.WebKitCSSMatrix,n=G&&"MozPerspective" in j.style,x=z&&"OTransition" in j.style,D=!d.L_NO_TOUCH&&function(){var h="ontouchstart";if(h in j){return !0}var g=document.createElement("div"),l=!1;return g.setAttribute?(g.setAttribute(h,"return;"),typeof g[h]=="function"&&(l=!0),g.removeAttribute(h),g=null,l):!1}(),C="devicePixelRatio" in d&&d.devicePixelRatio>1||"matchMedia" in d&&d.matchMedia("(min-resolution:144dpi)").matches;f.Browser={ua:e,ie:t,ie6:H,webkit:k,gecko:G,opera:z,android:q,android23:B,chrome:E,ie3d:A,webkit3d:F,gecko3d:n,opera3d:x,any3d:!d.L_DISABLE_3D&&(A||F||n||x),mobile:w,mobileWebkit:w&&k,mobileWebkit3d:w&&F,mobileOpera:w&&z,touch:D,retina:C}}(),f.Point=function(h,g,j){this.x=j?Math.round(h):h,this.y=j?Math.round(g):g},f.Point.prototype={add:function(g){return this.clone()._add(f.point(g))},_add:function(g){return this.x+=g.x,this.y+=g.y,this},subtract:function(g){return this.clone()._subtract(f.point(g))},_subtract:function(g){return this.x-=g.x,this.y-=g.y,this},divideBy:function(h,g){return new f.Point(this.x/h,this.y/h,g)},multiplyBy:function(h,g){return new f.Point(this.x*h,this.y*h,g)},distanceTo:function(j){j=f.point(j);var g=j.x-this.x,h=j.y-this.y;return Math.sqrt(g*g+h*h)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},clone:function(){return new f.Point(this.x,this.y)},toString:function(){return"Point("+f.Util.formatNum(this.x)+", "+f.Util.formatNum(this.y)+")"}},f.point=function(j,g,h){return j instanceof f.Point?j:j instanceof Array?new f.Point(j[0],j[1]):isNaN(j)?j:new f.Point(j,g,h)},f.Bounds=f.Class.extend({initialize:function(k,h){if(!k){return}var l=h?[k,h]:k;for(var j=0,g=l.length;j<g;j++){this.extend(l[j])}},extend:function(g){return g=f.point(g),!this.min&&!this.max?(this.min=g.clone(),this.max=g.clone()):(this.min.x=Math.min(g.x,this.min.x),this.max.x=Math.max(g.x,this.max.x),this.min.y=Math.min(g.y,this.min.y),this.max.y=Math.max(g.y,this.max.y)),this},getCenter:function(g){return new f.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,g)},getBottomLeft:function(){return new f.Point(this.min.x,this.max.y)},getTopRight:function(){return new f.Point(this.max.x,this.min.y)},contains:function(j){var g,h;return typeof j[0]=="number"||j instanceof f.Point?j=f.point(j):j=f.bounds(j),j instanceof f.Bounds?(g=j.min,h=j.max):g=h=j,g.x>=this.min.x&&h.x<=this.max.x&&g.y>=this.min.y&&h.y<=this.max.y},intersects:function(m){m=f.bounds(m);var j=this.min,l=this.max,h=m.min,k=m.max,n=k.x>=j.x&&h.x<=l.x,g=k.y>=j.y&&h.y<=l.y;return n&&g}}),f.bounds=function(h,g){return !h||h instanceof f.Bounds?h:new f.Bounds(h,g)},f.Transformation=f.Class.extend({initialize:function(j,g,k,h){this._a=j,this._b=g,this._c=k,this._d=h},transform:function(h,g){return this._transform(h.clone(),g)},_transform:function(h,g){return g=g||1,h.x=g*(this._a*h.x+this._b),h.y=g*(this._c*h.y+this._d),h},untransform:function(h,g){return g=g||1,new f.Point((h.x/g-this._b)/this._a,(h.y/g-this._d)/this._c)}}),f.DomUtil={get:function(g){return typeof g=="string"?document.getElementById(g):g},getStyle:function(j,g){var k=j.style[g];!k&&j.currentStyle&&(k=j.currentStyle[g]);if(!k||k==="auto"){var h=document.defaultView.getComputedStyle(j,null);k=h?h[g]:null}return k==="auto"?null:k},getViewportOffset:function(l){var h=0,k=0,g=l,j=document.body;do{h+=g.offsetTop||0,k+=g.offsetLeft||0;if(g.offsetParent===j&&f.DomUtil.getStyle(g,"position")==="absolute"){break}if(f.DomUtil.getStyle(g,"position")==="fixed"){h+=j.scrollTop||0,k+=j.scrollLeft||0;break}g=g.offsetParent}while(g);g=l;do{if(g===j){break}h-=g.scrollTop||0,k-=g.scrollLeft||0,g=g.parentNode}while(g);return new f.Point(k,h)},create:function(j,g,k){var h=document.createElement(j);return h.className=g,k&&k.appendChild(h),h},disableTextSelection:function(){document.selection&&document.selection.empty&&document.selection.empty(),this._onselectstart||(this._onselectstart=document.onselectstart,document.onselectstart=f.Util.falseFn)},enableTextSelection:function(){document.onselectstart=this._onselectstart,this._onselectstart=null},hasClass:function(h,g){return h.className.length>0&&RegExp("(^|\\s)"+g+"(\\s|$)").test(h.className)},addClass:function(h,g){f.DomUtil.hasClass(h,g)||(h.className+=(h.className?" ":"")+g)},removeClass:function(h,g){function j(k,l){return l===g?"":k}h.className=h.className.replace(/(\S+)\s*/g,j).replace(/(^\s+|\s+$)/,"")},setOpacity:function(l,h){if("opacity" in l.style){l.style.opacity=h}else{if(f.Browser.ie){var k=!1,g="DXImageTransform.Microsoft.Alpha";try{k=l.filters.item(g)}catch(j){}h=Math.round(h*100),k?(k.Enabled=h!==100,k.Opacity=h):l.style.filter+=" progid:"+g+"(opacity="+h+")"}}},testProp:function(h){var g=document.documentElement.style;for(var j=0;j<h.length;j++){if(h[j] in g){return h[j]}}return !1},getTranslateString:function(k){var h=f.Browser.webkit3d,j="translate"+(h?"3d":"")+"(",g=(h?",0":"")+")";return j+k.x+"px,"+k.y+"px"+g},getScaleString:function(k,h){var j=f.DomUtil.getTranslateString(h.add(h.multiplyBy(-1*k))),g=" scale("+k+") ";return j+g},setPosition:function(j,g,h){j._leaflet_pos=g,!h&&f.Browser.any3d?(j.style[f.DomUtil.TRANSFORM]=f.DomUtil.getTranslateString(g),f.Browser.mobileWebkit3d&&(j.style.WebkitBackfaceVisibility="hidden")):(j.style.left=g.x+"px",j.style.top=g.y+"px")},getPosition:function(g){return g._leaflet_pos}},f.Util.extend(f.DomUtil,{TRANSITION:f.DomUtil.testProp(["transition","webkitTransition","OTransition","MozTransition","msTransition"]),TRANSFORM:f.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"])}),f.LatLng=function(k,h,l){var j=parseFloat(k),g=parseFloat(h);if(isNaN(j)||isNaN(g)){throw Error("Invalid LatLng object: ("+k+", "+h+")")}l!==!0&&(j=Math.max(Math.min(j,90),-90),g=(g+180)%360+(g<-180||g===180?180:-180)),this.lat=j,this.lng=g},f.Util.extend(f.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),f.LatLng.prototype={equals:function(h){if(!h){return !1}h=f.latLng(h);var g=Math.max(Math.abs(this.lat-h.lat),Math.abs(this.lng-h.lng));return g<=f.LatLng.MAX_MARGIN},toString:function(){return"LatLng("+f.Util.formatNum(this.lat)+", "+f.Util.formatNum(this.lng)+")"},distanceTo:function(n){n=f.latLng(n);var v=6378137,g=f.LatLng.DEG_TO_RAD,k=(n.lat-this.lat)*g,w=(n.lng-this.lng)*g,h=this.lat*g,q=n.lat*g,p=Math.sin(k/2),m=Math.sin(w/2),j=p*p+m*m*Math.cos(h)*Math.cos(q);return v*2*Math.atan2(Math.sqrt(j),Math.sqrt(1-j))}},f.latLng=function(j,g,h){return j instanceof f.LatLng?j:j instanceof Array?new f.LatLng(j[0],j[1]):isNaN(j)?j:new f.LatLng(j,g,h)},f.LatLngBounds=f.Class.extend({initialize:function(k,h){if(!k){return}var l=h?[k,h]:k;for(var j=0,g=l.length;j<g;j++){this.extend(l[j])}},extend:function(g){return typeof g[0]=="number"||g instanceof f.LatLng?g=f.latLng(g):g=f.latLngBounds(g),g instanceof f.LatLng?!this._southWest&&!this._northEast?(this._southWest=new f.LatLng(g.lat,g.lng,!0),this._northEast=new f.LatLng(g.lat,g.lng,!0)):(this._southWest.lat=Math.min(g.lat,this._southWest.lat),this._southWest.lng=Math.min(g.lng,this._southWest.lng),this._northEast.lat=Math.max(g.lat,this._northEast.lat),this._northEast.lng=Math.max(g.lng,this._northEast.lng)):g instanceof f.LatLngBounds&&(this.extend(g._southWest),this.extend(g._northEast)),this},pad:function(l){var h=this._southWest,k=this._northEast,g=Math.abs(h.lat-k.lat)*l,j=Math.abs(h.lng-k.lng)*l;return new f.LatLngBounds(new f.LatLng(h.lat-g,h.lng-j),new f.LatLng(k.lat+g,k.lng+j))},getCenter:function(){return new f.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new f.LatLng(this._northEast.lat,this._southWest.lng,!0)},getSouthEast:function(){return new f.LatLng(this._southWest.lat,this._northEast.lng,!0)},contains:function(l){typeof l[0]=="number"||l instanceof f.LatLng?l=f.latLng(l):l=f.latLngBounds(l);var h=this._southWest,k=this._northEast,g,j;return l instanceof f.LatLngBounds?(g=l.getSouthWest(),j=l.getNorthEast()):g=j=l,g.lat>=h.lat&&j.lat<=k.lat&&g.lng>=h.lng&&j.lng<=k.lng},intersects:function(m){m=f.latLngBounds(m);var j=this._southWest,l=this._northEast,h=m.getSouthWest(),k=m.getNorthEast(),n=k.lat>=j.lat&&h.lat<=l.lat,g=k.lng>=j.lng&&h.lng<=l.lng;return n&&g},toBBoxString:function(){var h=this._southWest,g=this._northEast;return[h.lng,h.lat,g.lng,g.lat].join(",")},equals:function(g){return g?(g=f.latLngBounds(g),this._southWest.equals(g.getSouthWest())&&this._northEast.equals(g.getNorthEast())):!1}}),f.latLngBounds=function(h,g){return !h||h instanceof f.LatLngBounds?h:new f.LatLngBounds(h,g)},f.Projection={},f.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(l){var h=f.LatLng.DEG_TO_RAD,k=this.MAX_LATITUDE,g=Math.max(Math.min(k,l.lat),-k),j=l.lng*h,m=g*h;return m=Math.log(Math.tan(Math.PI/4+m/2)),new f.Point(j,m)},unproject:function(k){var h=f.LatLng.RAD_TO_DEG,j=k.x*h,g=(2*Math.atan(Math.exp(k.y))-Math.PI/2)*h;return new f.LatLng(g,j,!0)}},f.Projection.LonLat={project:function(g){return new f.Point(g.lng,g.lat)},unproject:function(g){return new f.LatLng(g.y,g.x,!0)}},f.CRS={latLngToPoint:function(j,g){var k=this.projection.project(j),h=this.scale(g);return this.transformation._transform(k,h)},pointToLatLng:function(j,g){var k=this.scale(g),h=this.transformation.untransform(j,k);return this.projection.unproject(h)},project:function(g){return this.projection.project(g)},scale:function(g){return 256*Math.pow(2,g)}},f.CRS.EPSG3857=f.Util.extend({},f.CRS,{code:"EPSG:3857",projection:f.Projection.SphericalMercator,transformation:new f.Transformation(0.5/Math.PI,0.5,-0.5/Math.PI,0.5),project:function(h){var g=this.projection.project(h),j=6378137;return g.multiplyBy(j)}}),f.CRS.EPSG900913=f.Util.extend({},f.CRS.EPSG3857,{code:"EPSG:900913"}),f.CRS.EPSG4326=f.Util.extend({},f.CRS,{code:"EPSG:4326",projection:f.Projection.LonLat,transformation:new f.Transformation(1/360,0.5,-1/360,0.5)}),f.Map=f.Class.extend({includes:f.Mixin.Events,options:{crs:f.CRS.EPSG3857,fadeAnimation:f.DomUtil.TRANSITION&&!f.Browser.android23,trackResize:!0,markerZoomAnimation:f.DomUtil.TRANSITION&&f.Browser.any3d},initialize:function(h,g){g=f.Util.setOptions(this,g),this._initContainer(h),this._initLayout(),this._initHooks(),this._initEvents(),g.maxBounds&&this.setMaxBounds(g.maxBounds),g.center&&g.zoom!==b&&this.setView(f.latLng(g.center),g.zoom,!0),this._initLayers(g.layers)},setView:function(h,g){return this._resetView(f.latLng(h),this._limitZoom(g)),this},setZoom:function(g){return this.setView(this.getCenter(),g)},zoomIn:function(){return this.setZoom(this._zoom+1)},zoomOut:function(){return this.setZoom(this._zoom-1)},fitBounds:function(h){var g=this.getBoundsZoom(h);return this.setView(f.latLngBounds(h).getCenter(),g)},fitWorld:function(){var h=new f.LatLng(-60,-170),g=new f.LatLng(85,179);return this.fitBounds(new f.LatLngBounds(h,g))},panTo:function(g){return this.setView(g,this._zoom)},panBy:function(g){return this.fire("movestart"),this._rawPanBy(f.point(g)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(h){h=f.latLngBounds(h),this.options.maxBounds=h;if(!h){return this._boundsMinZoom=null,this}var g=this.getBoundsZoom(h,!0);return this._boundsMinZoom=g,this._loaded&&(this._zoom<g?this.setView(h.getCenter(),g):this.panInsideBounds(h)),this},panInsideBounds:function(n){n=f.latLngBounds(n);var k=this.getBounds(),m=this.project(k.getSouthWest()),j=this.project(k.getNorthEast()),l=this.project(n.getSouthWest()),p=this.project(n.getNorthEast()),h=0,g=0;return j.y<p.y&&(g=p.y-j.y),j.x>p.x&&(h=p.x-j.x),m.y>l.y&&(g=l.y-m.y),m.x<l.x&&(h=l.x-m.x),this.panBy(new f.Point(h,g,!0))},addLayer:function(j){var g=f.Util.stamp(j);if(this._layers[g]){return this}this._layers[g]=j,j.options&&!isNaN(j.options.maxZoom)&&(this._layersMaxZoom=Math.max(this._layersMaxZoom||0,j.options.maxZoom)),j.options&&!isNaN(j.options.minZoom)&&(this._layersMinZoom=Math.min(this._layersMinZoom||Infinity,j.options.minZoom)),this.options.zoomAnimation&&f.TileLayer&&j instanceof f.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,j.on("load",this._onTileLayerLoad,this));var h=function(){j.onAdd(this),this.fire("layeradd",{layer:j})};return this._loaded?h.call(this):this.on("load",h,this),this},removeLayer:function(h){var g=f.Util.stamp(h);if(!this._layers[g]){return}return h.onRemove(this),delete this._layers[g],this.options.zoomAnimation&&f.TileLayer&&h instanceof f.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,h.off("load",this._onTileLayerLoad,this)),this.fire("layerremove",{layer:h})},hasLayer:function(h){var g=f.Util.stamp(h);return this._layers.hasOwnProperty(g)},invalidateSize:function(j){var g=this.getSize();this._sizeChanged=!0,this.options.maxBounds&&this.setMaxBounds(this.options.maxBounds);if(!this._loaded){return this}var h=g.subtract(this.getSize()).divideBy(2,!0);return j===!0?this.panBy(h):(this._rawPanBy(h),this.fire("move"),clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(f.Util.bind(this.fire,this,"moveend"),200)),this},addHandler:function(h,g){if(!g){return}return this[h]=new g(this),this.options[h]&&this[h].enable(),this},getCenter:function(){return this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var j=this.getPixelBounds(),g=this.unproject(j.getBottomLeft()),h=this.unproject(j.getTopRight());return new f.LatLngBounds(g,h)},getMinZoom:function(){var h=this.options.minZoom||0,g=this._layersMinZoom||0,j=this._boundsMinZoom||0;return Math.max(h,g,j)},getMaxZoom:function(){var g=this.options.maxZoom===b?Infinity:this.options.maxZoom,h=this._layersMaxZoom===b?Infinity:this._layersMaxZoom;return Math.min(g,h)},getBoundsZoom:function(n,w){n=f.latLngBounds(n);var g=this.getSize(),k=this.options.minZoom||0,x=this.getMaxZoom(),h=n.getNorthEast(),v=n.getSouthWest(),q,m,j,p=!0;w&&k--;do{k++,m=this.project(h,k),j=this.project(v,k),q=new f.Point(Math.abs(m.x-j.x),Math.abs(j.y-m.y)),w?p=q.x<g.x||q.y<g.y:p=q.x<=g.x&&q.y<=g.y}while(p&&k<=x);return p&&w?null:w?k:k-1},getSize:function(){if(!this._size||this._sizeChanged){this._size=new f.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1}return this._size},getPixelBounds:function(){var g=this._getTopLeftPoint();return new f.Bounds(g,g.add(this.getSize()))},getPixelOrigin:function(){return this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(h){var g=this.options.crs;return g.scale(h)/g.scale(this._zoom)},getScaleZoom:function(g){return this._zoom+Math.log(g)/Math.LN2},project:function(h,g){return g=g===b?this._zoom:g,this.options.crs.latLngToPoint(f.latLng(h),g)},unproject:function(h,g){return g=g===b?this._zoom:g,this.options.crs.pointToLatLng(f.point(h),g)},layerPointToLatLng:function(h){var g=f.point(h).add(this._initialTopLeftPoint);return this.unproject(g)},latLngToLayerPoint:function(h){var g=this.project(f.latLng(h))._round();return g._subtract(this._initialTopLeftPoint)},containerPointToLayerPoint:function(g){return f.point(g).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(g){return f.point(g).add(this._getMapPanePos())},containerPointToLatLng:function(h){var g=this.containerPointToLayerPoint(f.point(h));return this.layerPointToLatLng(g)},latLngToContainerPoint:function(g){return this.layerPointToContainerPoint(this.latLngToLayerPoint(f.latLng(g)))},mouseEventToContainerPoint:function(g){return f.DomEvent.getMousePosition(g,this._container)},mouseEventToLayerPoint:function(g){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(g))},mouseEventToLatLng:function(g){return this.layerPointToLatLng(this.mouseEventToLayerPoint(g))},_initContainer:function(h){var g=this._container=f.DomUtil.get(h);if(g._leaflet){throw Error("Map container is already initialized.")}g._leaflet=!0},_initLayout:function(){var h=this._container;h.innerHTML="",f.DomUtil.addClass(h,"leaflet-container"),f.Browser.touch&&f.DomUtil.addClass(h,"leaflet-touch"),this.options.fadeAnimation&&f.DomUtil.addClass(h,"leaflet-fade-anim");var g=f.DomUtil.getStyle(h,"position");g!=="absolute"&&g!=="relative"&&g!=="fixed"&&(h.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var h=this._panes={};this._mapPane=h.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=h.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),this._objectsPane=h.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),h.shadowPane=this._createPane("leaflet-shadow-pane"),h.overlayPane=this._createPane("leaflet-overlay-pane"),h.markerPane=this._createPane("leaflet-marker-pane"),h.popupPane=this._createPane("leaflet-popup-pane");var g=" leaflet-zoom-hide";this.options.markerZoomAnimation||(f.DomUtil.addClass(h.markerPane,g),f.DomUtil.addClass(h.shadowPane,g),f.DomUtil.addClass(h.popupPane,g))},_createPane:function(h,g){return f.DomUtil.create("div",h,g||this._objectsPane)},_initializers:[],_initHooks:function(){var h,g;for(h=0,g=this._initializers.length;h<g;h++){this._initializers[h].call(this)}},_initLayers:function(h){h=h?h instanceof Array?h:[h]:[],this._layers={},this._tileLayersNum=0;var g,j;for(g=0,j=h.length;g<j;g++){this.addLayer(h[g])}},_resetView:function(l,h,k,g){var j=this._zoom!==h;g||(this.fire("movestart"),j&&this.fire("zoomstart")),this._zoom=h,this._initialTopLeftPoint=this._getNewTopLeftPoint(l),k?this._initialTopLeftPoint._add(this._getMapPanePos()):f.DomUtil.setPosition(this._mapPane,new f.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum,this.fire("viewreset",{hard:!k}),this.fire("move"),(j||g)&&this.fire("zoomend"),this.fire("moveend",{hard:!k}),this._loaded||(this._loaded=!0,this.fire("load"))},_rawPanBy:function(g){f.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(g))},_initEvents:function(){if(!f.DomEvent){return}f.DomEvent.on(this._container,"click",this._onMouseClick,this);var g=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"],h,e;for(h=0,e=g.length;h<e;h++){f.DomEvent.on(this._container,g[h],this._fireMouseEvent,this)}this.options.trackResize&&f.DomEvent.on(d,"resize",this._onResize,this)},_onResize:function(){f.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=f.Util.requestAnimFrame(this.invalidateSize,this,!1,this._container)},_onMouseClick:function(g){if(!this._loaded||this.dragging&&this.dragging.moved()){return}this.fire("preclick"),this._fireMouseEvent(g)},_fireMouseEvent:function(l){if(!this._loaded){return}var h=l.type;h=h==="mouseenter"?"mouseover":h==="mouseleave"?"mouseout":h;if(!this.hasEventListeners(h)){return}h==="contextmenu"&&f.DomEvent.preventDefault(l);var k=this.mouseEventToContainerPoint(l),g=this.containerPointToLayerPoint(k),j=this.layerPointToLatLng(g);this.fire(h,{latlng:j,layerPoint:g,containerPoint:k,originalEvent:l})},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this._tileBg&&(clearTimeout(this._clearTileBgTimer),this._clearTileBgTimer=setTimeout(f.Util.bind(this._clearTileBg,this),500))},_getMapPanePos:function(){return f.DomUtil.getPosition(this._mapPane)},_getTopLeftPoint:function(){if(!this._loaded){throw Error("Set map center and zoom first.")}return this._initialTopLeftPoint.subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(h,g){var j=this.getSize().divideBy(2);return this.project(h,g)._subtract(j)._round()},_latLngToNewLayerPoint:function(j,g,k){var h=this._getNewTopLeftPoint(k,g).add(this._getMapPanePos());return this.project(j,g)._subtract(h)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize().divideBy(2))},_getCenterOffset:function(g){return this.latLngToLayerPoint(g).subtract(this._getCenterLayerPoint())},_limitZoom:function(h){var g=this.getMinZoom(),j=this.getMaxZoom();return Math.max(g,Math.min(j,h))}}),f.Map.addInitHook=function(h){var g=Array.prototype.slice.call(arguments,1),j=typeof h=="function"?h:function(){this[h].apply(this,g)};this.prototype._initializers.push(j)},f.map=function(h,g){return new f.Map(h,g)},f.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.3142,R_MAJOR:6378137,project:function(q){var y=f.LatLng.DEG_TO_RAD,g=this.MAX_LATITUDE,m=Math.max(Math.min(g,q.lat),-g),z=this.R_MAJOR,j=this.R_MINOR,x=q.lng*y*z,w=m*y,p=j/z,k=Math.sqrt(1-p*p),v=k*Math.sin(w);v=Math.pow((1-v)/(1+v),k*0.5);var n=Math.tan(0.5*(Math.PI*0.5-w))/v;return w=-j*Math.log(n),new f.Point(x,w)},unproject:function(w){var B=f.LatLng.RAD_TO_DEG,g=this.R_MAJOR,n=this.R_MINOR,C=w.x*B/g,k=n/g,A=Math.sqrt(1-k*k),z=Math.exp(-w.y/n),v=Math.PI/2-2*Math.atan(z),m=15,y=1e-7,q=m,j=0.1,x;while(Math.abs(j)>y&&--q>0){x=A*Math.sin(v),j=Math.PI/2-2*Math.atan(z*Math.pow((1-x)/(1+x),0.5*A))-v,v+=j}return new f.LatLng(v*B,C,!0)}},f.CRS.EPSG3395=f.Util.extend({},f.CRS,{code:"EPSG:3395",projection:f.Projection.Mercator,transformation:function(){var j=f.Projection.Mercator,g=j.R_MAJOR,h=j.R_MINOR;return new f.Transformation(0.5/(Math.PI*g),0.5,-0.5/(Math.PI*h),0.5)}()}),f.TileLayer=f.Class.extend({includes:f.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:f.Browser.mobile,updateWhenIdle:f.Browser.mobile},initialize:function(j,g){g=f.Util.setOptions(this,g),g.detectRetina&&f.Browser.retina&&g.maxZoom>0&&(g.tileSize=Math.floor(g.tileSize/2),g.zoomOffset++,g.minZoom>0&&g.minZoom--,this.options.maxZoom--),this._url=j;var h=this.options.subdomains;typeof h=="string"&&(this.options.subdomains=h.split(""))},onAdd:function(g){this._map=g,this._initContainer(),this._createTileProto(),g.on({viewreset:this._resetCallback,moveend:this._update},this),this.options.updateWhenIdle||(this._limitedUpdate=f.Util.limitExecByInterval(this._update,150,this),g.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(g){return g.addLayer(this),this},onRemove:function(g){g._panes.tilePane.removeChild(this._container),g.off({viewreset:this._resetCallback,moveend:this._update},this),this.options.updateWhenIdle||g.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var g=this._map._panes.tilePane;return this._container&&(g.appendChild(this._container),this._setAutoZIndex(g,Math.max)),this},bringToBack:function(){var g=this._map._panes.tilePane;return this._container&&(g.insertBefore(this._container,g.firstChild),this._setAutoZIndex(g,Math.min)),this},getAttribution:function(){return this.options.attribution},setOpacity:function(g){return this.options.opacity=g,this._map&&this._updateOpacity(),this},setZIndex:function(g){return this.options.zIndex=g,this._updateZIndex(),this},setUrl:function(h,g){return this._url=h,g||this.redraw(),this},redraw:function(){return this._map&&(this._map._panes.tilePane.empty=!1,this._reset(!0),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==b&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(l,h){var p=l.getElementsByClassName("leaflet-layer"),k=-h(Infinity,-Infinity),g;for(var j=0,m=p.length;j<m;j++){p[j]!==this._container&&(g=parseInt(p[j].style.zIndex,10),isNaN(g)||(k=h(k,g)))}this._container.style.zIndex=isFinite(k)?k+h(1,-1):""},_updateOpacity:function(){f.DomUtil.setOpacity(this._container,this.options.opacity);var h,g=this._tiles;if(f.Browser.webkit){for(h in g){g.hasOwnProperty(h)&&(g[h].style.webkitTransform+=" translate(0,0)")}}},_initContainer:function(){var g=this._map._panes.tilePane;if(!this._container||g.empty){this._container=f.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),g.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_resetCallback:function(g){this._reset(g.hard)},_reset:function(h){var g,j=this._tiles;for(g in j){j.hasOwnProperty(g)&&this.fire("tileunload",{tile:j[g]})}this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),h&&this._container&&(this._container.innerHTML=""),this._initContainer()},_update:function(m){if(this._map._panTransition&&this._map._panTransition._inProgress){return}var j=this._map.getPixelBounds(),l=this._map.getZoom(),h=this.options.tileSize;if(l>this.options.maxZoom||l<this.options.minZoom){return}var k=new f.Point(Math.floor(j.min.x/h),Math.floor(j.min.y/h)),n=new f.Point(Math.floor(j.max.x/h),Math.floor(j.max.y/h)),g=new f.Bounds(k,n);this._addTilesFromCenterOut(g),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(g)},_addTilesFromCenterOut:function(n){var k=[],m=n.getCenter(),j,l,p;for(j=n.min.y;j<=n.max.y;j++){for(l=n.min.x;l<=n.max.x;l++){p=new f.Point(l,j),this._tileShouldBeLoaded(p)&&k.push(p)}}var h=k.length;if(h===0){return}k.sort(function(q,o){return q.distanceTo(m)-o.distanceTo(m)});var g=document.createDocumentFragment();this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=h;for(l=0;l<h;l++){this._addTile(k[l],g)}this._container.appendChild(g)},_tileShouldBeLoaded:function(h){if(h.x+":"+h.y in this._tiles){return !1}if(!this.options.continuousWorld){var g=this._getWrapTileNum();if(this.options.noWrap&&(h.x<0||h.x>=g)||h.y<0||h.y>=g){return !1}}return !0},_removeOtherTiles:function(k){var h,l,j,g;for(g in this._tiles){this._tiles.hasOwnProperty(g)&&(h=g.split(":"),l=parseInt(h[0],10),j=parseInt(h[1],10),(l<k.min.x||l>k.max.x||j<k.min.y||j>k.max.y)&&this._removeTile(g))}},_removeTile:function(h){var g=this._tiles[h];this.fire("tileunload",{tile:g,url:g.src}),this.options.reuseTiles?(f.DomUtil.removeClass(g,"leaflet-tile-loaded"),this._unusedTiles.push(g)):g.parentNode===this._container&&this._container.removeChild(g),f.Browser.android||(g.src=f.Util.emptyImageUrl),delete this._tiles[h]},_addTile:function(k,h){var j=this._getTilePos(k),g=this._getTile();f.DomUtil.setPosition(g,j,f.Browser.chrome||f.Browser.android23),this._tiles[k.x+":"+k.y]=g,this._loadTile(g,k),g.parentNode!==this._container&&h.appendChild(g)},_getZoomForUrl:function(){var h=this.options,g=this._map.getZoom();return h.zoomReverse&&(g=h.maxZoom-g),g+h.zoomOffset},_getTilePos:function(h){var g=this._map.getPixelOrigin(),j=this.options.tileSize;return h.multiplyBy(j).subtract(g)},getTileUrl:function(g){return this._adjustTilePoint(g),f.Util.template(this._url,f.Util.extend({s:this._getSubdomain(g),z:this._getZoomForUrl(),x:g.x,y:g.y},this.options))},_getWrapTileNum:function(){return Math.pow(2,this._getZoomForUrl())},_adjustTilePoint:function(h){var g=this._getWrapTileNum();!this.options.continuousWorld&&!this.options.noWrap&&(h.x=(h.x%g+g)%g),this.options.tms&&(h.y=g-h.y-1)},_getSubdomain:function(h){var g=(h.x+h.y)%this.options.subdomains.length;return this.options.subdomains[g]},_createTileProto:function(){var h=this._tileImg=f.DomUtil.create("img","leaflet-tile");h.galleryimg="no";var g=this.options.tileSize;h.style.width=g+"px",h.style.height=g+"px"},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var g=this._unusedTiles.pop();return this._resetTile(g),g}return this._createTile()},_resetTile:function(g){},_createTile:function(){var g=this._tileImg.cloneNode(!1);return g.onselectstart=g.onmousemove=f.Util.falseFn,g},_loadTile:function(h,g){h._layer=this,h.onload=this._tileOnLoad,h.onerror=this._tileOnError,h.src=this.getTileUrl(g)},_tileLoaded:function(){this._tilesToLoad--,this._tilesToLoad||this.fire("load")},_tileOnLoad:function(h){var g=this._layer;this.src!==f.Util.emptyImageUrl&&(f.DomUtil.addClass(this,"leaflet-tile-loaded"),g.fire("tileload",{tile:this,url:this.src})),g._tileLoaded()},_tileOnError:function(h){var g=this._layer;g.fire("tileerror",{tile:this,url:this.src});var j=g.options.errorTileUrl;j&&(this.src=j),g._tileLoaded()}}),f.tileLayer=function(h,g){return new f.TileLayer(h,g)},f.TileLayer.WMS=f.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(k,h){this._url=k;var j=f.Util.extend({},this.defaultWmsParams);h.detectRetina&&f.Browser.retina?j.width=j.height=this.options.tileSize*2:j.width=j.height=this.options.tileSize;for(var g in h){this.options.hasOwnProperty(g)||(j[g]=h[g])}this.wmsParams=j,f.Util.setOptions(this,h)},onAdd:function(h){var g=parseFloat(this.wmsParams.version)>=1.3?"crs":"srs";this.wmsParams[g]=h.options.crs.code,f.TileLayer.prototype.onAdd.call(this,h)},getTileUrl:function(n,w){var g=this._map,k=g.options.crs,x=this.options.tileSize,h=n.multiplyBy(x),v=h.add(new f.Point(x,x)),q=k.project(g.unproject(h,w)),m=k.project(g.unproject(v,w)),j=[q.x,m.y,m.x,q.y].join(","),p=f.Util.template(this._url,{s:this._getSubdomain(n)});return p+f.Util.getParamString(this.wmsParams)+"&bbox="+j},setParams:function(h,g){return f.Util.extend(this.wmsParams,h),g||this.redraw(),this}}),f.tileLayer.wms=function(h,g){return new f.TileLayer.WMS(h,g)},f.TileLayer.Canvas=f.TileLayer.extend({options:{async:!1},initialize:function(g){f.Util.setOptions(this,g)},redraw:function(){var h,g=this._tiles;for(h in g){g.hasOwnProperty(h)&&this._redrawTile(g[h])}},_redrawTile:function(g){this.drawTile(g,g._tilePoint,g._zoom)},_createTileProto:function(){var h=this._canvasProto=f.DomUtil.create("canvas","leaflet-tile"),g=this.options.tileSize;h.width=g,h.height=g},_createTile:function(){var g=this._canvasProto.cloneNode(!1);return g.onselectstart=g.onmousemove=f.Util.falseFn,g},_loadTile:function(h,g,j){h._layer=this,h._tilePoint=g,h._zoom=j,this.drawTile(h,g,j),this.options.async||this.tileDrawn(h)},drawTile:function(h,g,j){},tileDrawn:function(g){this._tileOnLoad.call(g)}}),f.tileLayer.canvas=function(g){return new f.TileLayer.Canvas(g)},f.ImageOverlay=f.Class.extend({includes:f.Mixin.Events,options:{opacity:1},initialize:function(j,g,h){this._url=j,this._bounds=f.latLngBounds(g),f.Util.setOptions(this,h)},onAdd:function(g){this._map=g,this._image||this._initImage(),g._panes.overlayPane.appendChild(this._image),g.on("viewreset",this._reset,this),g.options.zoomAnimation&&f.Browser.any3d&&g.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(g){g.getPanes().overlayPane.removeChild(this._image),g.off("viewreset",this._reset,this),g.options.zoomAnimation&&g.off("zoomanim",this._animateZoom,this)},addTo:function(g){return g.addLayer(this),this},setOpacity:function(g){return this.options.opacity=g,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var g=this._map._panes.overlayPane;return this._image&&g.insertBefore(this._image,g.firstChild),this},_initImage:function(){this._image=f.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&f.Browser.any3d?f.DomUtil.addClass(this._image,"leaflet-zoom-animated"):f.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),f.Util.extend(this._image,{galleryimg:"no",onselectstart:f.Util.falseFn,onmousemove:f.Util.falseFn,onload:f.Util.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(n){var v=this._map,g=this._image,k=v.getZoomScale(n.zoom),w=this._bounds.getNorthWest(),h=this._bounds.getSouthEast(),q=v._latLngToNewLayerPoint(w,n.zoom,n.center),p=v._latLngToNewLayerPoint(h,n.zoom,n.center).subtract(q),m=v.latLngToLayerPoint(h).subtract(v.latLngToLayerPoint(w)),j=q.add(p.subtract(m).divideBy(2));g.style[f.DomUtil.TRANSFORM]=f.DomUtil.getTranslateString(j)+" scale("+k+") "},_reset:function(){var j=this._image,g=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),h=this._map.latLngToLayerPoint(this._bounds.getSouthEast()).subtract(g);f.DomUtil.setPosition(j,g),j.style.width=h.x+"px",j.style.height=h.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){f.DomUtil.setOpacity(this._image,this.options.opacity)}}),f.imageOverlay=function(j,g,h){return new f.ImageOverlay(j,g,h)},f.Icon=f.Class.extend({options:{className:""},initialize:function(g){f.Util.setOptions(this,g)},createIcon:function(){return this._createIcon("icon")},createShadow:function(){return this._createIcon("shadow")},_createIcon:function(h){var g=this._getIconUrl(h);if(!g){if(h==="icon"){throw Error("iconUrl not set in Icon options (see the docs).")}return null}var j=this._createImg(g);return this._setIconStyles(j,h),j},_setIconStyles:function(l,h){var k=this.options,g=f.point(k[h+"Size"]),j;h==="shadow"?j=f.point(k.shadowAnchor||k.iconAnchor):j=f.point(k.iconAnchor),!j&&g&&(j=g.divideBy(2,!0)),l.className="leaflet-marker-"+h+" "+k.className,j&&(l.style.marginLeft=-j.x+"px",l.style.marginTop=-j.y+"px"),g&&(l.style.width=g.x+"px",l.style.height=g.y+"px")},_createImg:function(h){var g;return f.Browser.ie6?(g=document.createElement("div"),g.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+h+'")'):(g=document.createElement("img"),g.src=h),g},_getIconUrl:function(g){return this.options[g+"Url"]}}),f.icon=function(g){return new f.Icon(g)},f.Icon.Default=f.Icon.extend({options:{iconSize:new f.Point(25,41),iconAnchor:new f.Point(13,41),popupAnchor:new f.Point(1,-34),shadowSize:new f.Point(41,41)},_getIconUrl:function(j){var g=j+"Url";if(this.options[g]){return this.options[g]}var h=f.Icon.Default.imagePath;if(!h){throw Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.")}return h+"/marker-"+j+".png"}}),f.Icon.Default.imagePath=function(){var l=document.getElementsByTagName("script"),h=/\/?leaflet[\-\._]?([\w\-\._]*)\.js\??/,m,k,g,j;for(m=0,k=l.length;m<k;m++){g=l[m].src,j=g.match(h);if(j){return g.split(h)[0]+"/images"}}}(),f.Marker=f.Class.extend({includes:f.Mixin.Events,options:{icon:new f.Icon.Default,title:"",clickable:!0,draggable:!1,zIndexOffset:0,opacity:1},initialize:function(h,g){f.Util.setOptions(this,g),this._latlng=f.latLng(h)},onAdd:function(g){this._map=g,g.on("viewreset",this.update,this),this._initIcon(),this.update(),g.options.zoomAnimation&&g.options.markerZoomAnimation&&g.on("zoomanim",this._animateZoom,this)},addTo:function(g){return g.addLayer(this),this},onRemove:function(g){this._removeIcon(),this.closePopup&&this.closePopup(),g.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(g){this._latlng=f.latLng(g),this.update(),this._popup&&this._popup.setLatLng(g)},setZIndexOffset:function(g){this.options.zIndexOffset=g,this.update()},setIcon:function(g){this._map&&this._removeIcon(),this.options.icon=g,this._map&&(this._initIcon(),this.update())},update:function(){if(!this._icon){return}var g=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(g)},_initIcon:function(){var l=this.options,h=this._map,k=h.options.zoomAnimation&&h.options.markerZoomAnimation,g=k?"leaflet-zoom-animated":"leaflet-zoom-hide",j=!1;this._icon||(this._icon=l.icon.createIcon(),l.title&&(this._icon.title=l.title),this._initInteraction(),j=this.options.opacity<1,f.DomUtil.addClass(this._icon,g)),this._shadow||(this._shadow=l.icon.createShadow(),this._shadow&&(f.DomUtil.addClass(this._shadow,g),j=this.options.opacity<1)),j&&this._updateOpacity();var m=this._map._panes;m.markerPane.appendChild(this._icon),this._shadow&&m.shadowPane.appendChild(this._shadow)},_removeIcon:function(){var g=this._map._panes;g.markerPane.removeChild(this._icon),this._shadow&&g.shadowPane.removeChild(this._shadow),this._icon=this._shadow=null},_setPos:function(g){f.DomUtil.setPosition(this._icon,g),this._shadow&&f.DomUtil.setPosition(this._shadow,g),this._icon.style.zIndex=g.y+this.options.zIndexOffset},_animateZoom:function(h){var g=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center);this._setPos(g)},_initInteraction:function(){if(!this.options.clickable){return}var j=this._icon,g=["dblclick","mousedown","mouseover","mouseout"];f.DomUtil.addClass(j,"leaflet-clickable"),f.DomEvent.on(j,"click",this._onMouseClick,this);for(var h=0;h<g.length;h++){f.DomEvent.on(j,g[h],this._fireMouseEvent,this)}f.Handler.MarkerDrag&&(this.dragging=new f.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())},_onMouseClick:function(g){f.DomEvent.stopPropagation(g);if(this.dragging&&this.dragging.moved()){return}if(this._map.dragging&&this._map.dragging.moved()){return}this.fire(g.type,{originalEvent:g})},_fireMouseEvent:function(g){this.fire(g.type,{originalEvent:g}),g.type!=="mousedown"&&f.DomEvent.stopPropagation(g)},setOpacity:function(g){this.options.opacity=g,this._map&&this._updateOpacity()},_updateOpacity:function(){f.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&f.DomUtil.setOpacity(this._shadow,this.options.opacity)}}),f.marker=function(h,g){return new f.Marker(h,g)},f.DivIcon=f.Icon.extend({options:{iconSize:new f.Point(12,12),className:"leaflet-div-icon"},createIcon:function(){var h=document.createElement("div"),g=this.options;return g.html&&(h.innerHTML=g.html),g.bgPos&&(h.style.backgroundPosition=-g.bgPos.x+"px "+-g.bgPos.y+"px"),this._setIconStyles(h,"icon"),h},createShadow:function(){return null}}),f.divIcon=function(g){return new f.DivIcon(g)},f.Map.mergeOptions({closePopupOnClick:!0}),f.Popup=f.Class.extend({includes:f.Mixin.Events,options:{minWidth:50,maxWidth:300,maxHeight:null,autoPan:!0,closeButton:!0,offset:new f.Point(0,6),autoPanPadding:new f.Point(5,5),className:""},initialize:function(h,g){f.Util.setOptions(this,h),this._source=g},onAdd:function(h){this._map=h,this._container||this._initLayout(),this._updateContent();var g=h.options.fadeAnimation;g&&f.DomUtil.setOpacity(this._container,0),h._panes.popupPane.appendChild(this._container),h.on("viewreset",this._updatePosition,this),f.Browser.any3d&&h.on("zoomanim",this._zoomAnimation,this),h.options.closePopupOnClick&&h.on("preclick",this._close,this),this._update(),g&&f.DomUtil.setOpacity(this._container,1)},addTo:function(g){return g.addLayer(this),this},openOn:function(g){return g.openPopup(this),this},onRemove:function(g){g._panes.popupPane.removeChild(this._container),f.Util.falseFn(this._container.offsetWidth),g.off({viewreset:this._updatePosition,preclick:this._close,zoomanim:this._zoomAnimation},this),g.options.fadeAnimation&&f.DomUtil.setOpacity(this._container,0),this._map=null},setLatLng:function(g){return this._latlng=f.latLng(g),this._update(),this},setContent:function(g){return this._content=g,this._update(),this},_close:function(){var g=this._map;g&&(g._popup=null,g.removeLayer(this).fire("popupclose",{popup:this}))},_initLayout:function(){var k="leaflet-popup",h=this._container=f.DomUtil.create("div",k+" "+this.options.className+" leaflet-zoom-animated"),j;this.options.closeButton&&(j=this._closeButton=f.DomUtil.create("a",k+"-close-button",h),j.href="#close",j.innerHTML="&#215;",f.DomEvent.on(j,"click",this._onCloseButtonClick,this));var g=this._wrapper=f.DomUtil.create("div",k+"-content-wrapper",h);f.DomEvent.disableClickPropagation(g),this._contentNode=f.DomUtil.create("div",k+"-content",g),f.DomEvent.on(this._contentNode,"mousewheel",f.DomEvent.stopPropagation),this._tipContainer=f.DomUtil.create("div",k+"-tip-container",h),this._tip=f.DomUtil.create("div",k+"-tip",this._tipContainer)},_update:function(){if(!this._map){return}this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan()},_updateContent:function(){if(!this._content){return}if(typeof this._content=="string"){this._contentNode.innerHTML=this._content}else{while(this._contentNode.hasChildNodes()){this._contentNode.removeChild(this._contentNode.firstChild)}this._contentNode.appendChild(this._content)}this.fire("contentupdate")},_updateLayout:function(){var l=this._contentNode,h=l.style;h.width="",h.whiteSpace="nowrap";var k=l.offsetWidth;k=Math.min(k,this.options.maxWidth),k=Math.max(k,this.options.minWidth),h.width=k+1+"px",h.whiteSpace="",h.height="";var g=l.offsetHeight,j=this.options.maxHeight,m="leaflet-popup-scrolled";j&&g>j?(h.height=j+"px",f.DomUtil.addClass(l,m)):f.DomUtil.removeClass(l,m),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){var j=this._map.latLngToLayerPoint(this._latlng),g=f.Browser.any3d,h=this.options.offset;g&&f.DomUtil.setPosition(this._container,j),this._containerBottom=-h.y-(g?0:j.y),this._containerLeft=-Math.round(this._containerWidth/2)+h.x+(g?0:j.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"},_zoomAnimation:function(h){var g=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center);f.DomUtil.setPosition(this._container,g)},_adjustPan:function(){if(!this.options.autoPan){return}var l=this._map,p=this._container.offsetHeight,g=this._containerWidth,j=new f.Point(this._containerLeft,-p-this._containerBottom);f.Browser.any3d&&j._add(f.DomUtil.getPosition(this._container));var q=l.layerPointToContainerPoint(j),h=this.options.autoPanPadding,n=l.getSize(),m=0,k=0;q.x<0&&(m=q.x-h.x),q.x+g>n.x&&(m=q.x+g-n.x+h.x),q.y<0&&(k=q.y-h.y),q.y+p>n.y&&(k=q.y+p-n.y+h.y),(m||k)&&l.panBy(new f.Point(m,k))},_onCloseButtonClick:function(g){this._close(),f.DomEvent.stop(g)}}),f.popup=function(h,g){return new f.Popup(h,g)},f.Marker.include({openPopup:function(){return this._popup&&this._map&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},bindPopup:function(j,g){var h=f.point(this.options.icon.options.popupAnchor)||new f.Point(0,0);return h=h.add(f.Popup.prototype.options.offset),g&&g.offset&&(h=h.add(g.offset)),g=f.Util.extend({offset:h},g),this._popup||this.on("click",this.openPopup,this),this._popup=(new f.Popup(g,this)).setContent(j),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.openPopup)),this}}),f.Map.include({openPopup:function(g){return this.closePopup(),this._popup=g,this.addLayer(g).fire("popupopen",{popup:this._popup})},closePopup:function(){return this._popup&&this._popup._close(),this}}),f.LayerGroup=f.Class.extend({initialize:function(h){this._layers={};var g,j;if(h){for(g=0,j=h.length;g<j;g++){this.addLayer(h[g])}}},addLayer:function(h){var g=f.Util.stamp(h);return this._layers[g]=h,this._map&&this._map.addLayer(h),this},removeLayer:function(h){var g=f.Util.stamp(h);return delete this._layers[g],this._map&&this._map.removeLayer(h),this},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(j){var g=Array.prototype.slice.call(arguments,1),k,h;for(k in this._layers){this._layers.hasOwnProperty(k)&&(h=this._layers[k],h[j]&&h[j].apply(h,g))}return this},onAdd:function(g){this._map=g,this.eachLayer(g.addLayer,g)},onRemove:function(g){this.eachLayer(g.removeLayer,g),this._map=null},addTo:function(g){return g.addLayer(this),this},eachLayer:function(h,g){for(var j in this._layers){this._layers.hasOwnProperty(j)&&h.call(g,this._layers[j])}}}),f.layerGroup=function(g){return new f.LayerGroup(g)},f.FeatureGroup=f.LayerGroup.extend({includes:f.Mixin.Events,addLayer:function(g){return this._layers[f.Util.stamp(g)]?this:(g.on("click dblclick mouseover mouseout mousemove contextmenu",this._propagateEvent,this),f.LayerGroup.prototype.addLayer.call(this,g),this._popupContent&&g.bindPopup&&g.bindPopup(this._popupContent),this)},removeLayer:function(g){return g.off("click dblclick mouseover mouseout mousemove contextmenu",this._propagateEvent,this),f.LayerGroup.prototype.removeLayer.call(this,g),this._popupContent?this.invoke("unbindPopup"):this},bindPopup:function(g){return this._popupContent=g,this.invoke("bindPopup",g)},setStyle:function(g){return this.invoke("setStyle",g)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var g=new f.LatLngBounds;return this.eachLayer(function(e){g.extend(e instanceof f.Marker?e.getLatLng():e.getBounds())},this),g},_propagateEvent:function(g){g.layer=g.target,g.target=this,this.fire(g.type,g)}}),f.featureGroup=function(g){return new f.FeatureGroup(g)},f.Path=f.Class.extend({includes:[f.Mixin.Events],statics:{CLIP_PADDING:f.Browser.mobile?Math.max(0,Math.min(0.5,(1280/Math.max(d.innerWidth,d.innerHeight)-1)/2)):0.5},options:{stroke:!0,color:"#0033ff",dashArray:null,weight:5,opacity:0.5,fill:!1,fillColor:null,fillOpacity:0.2,clickable:!0},initialize:function(g){f.Util.setOptions(this,g)},onAdd:function(g){this._map=g,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),g.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(g){return g.addLayer(this),this},onRemove:function(g){g._pathRoot.removeChild(this._container),this._map=null,f.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),g.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(g){return f.Util.setOptions(this,g),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),f.Map.include({_updatePathViewport:function(){var l=f.Path.CLIP_PADDING,h=this.getSize(),k=f.DomUtil.getPosition(this._mapPane),g=k.multiplyBy(-1)._subtract(h.multiplyBy(l)),j=g.add(h.multiplyBy(1+l*2));this._pathViewport=new f.Bounds(g,j)}}),f.Path.SVG_NS="http://www.w3.org/2000/svg",f.Browser.svg=!!document.createElementNS&&!!document.createElementNS(f.Path.SVG_NS,"svg").createSVGRect,f.Path=f.Path.extend({statics:{SVG:f.Browser.svg},bringToFront:function(){return this._container&&this._map._pathRoot.appendChild(this._container),this},bringToBack:function(){if(this._container){var g=this._map._pathRoot;g.insertBefore(this._container,g.firstChild)}return this},getPathString:function(){},_createElement:function(g){return document.createElementNS(f.Path.SVG_NS,g)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray")):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var g=this.getPathString();g||(g="M0 0"),this._path.setAttribute("d",g)},_initEvents:function(){if(this.options.clickable){(f.Browser.svg||!f.Browser.vml)&&this._path.setAttribute("class","leaflet-clickable"),f.DomEvent.on(this._container,"click",this._onMouseClick,this);var h=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"];for(var g=0;g<h.length;g++){f.DomEvent.on(this._container,h[g],this._fireMouseEvent,this)}}},_onMouseClick:function(g){if(this._map.dragging&&this._map.dragging.moved()){return}this._fireMouseEvent(g),f.DomEvent.stopPropagation(g)},_fireMouseEvent:function(l){if(!this.hasEventListeners(l.type)){return}l.type==="contextmenu"&&f.DomEvent.preventDefault(l);var h=this._map,k=h.mouseEventToContainerPoint(l),g=h.containerPointToLayerPoint(k),j=h.layerPointToLatLng(g);this.fire(l.type,{latlng:j,layerPoint:g,containerPoint:k,originalEvent:l})}}),f.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=f.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&f.Browser.any3d?(this._pathRoot.setAttribute("class"," leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):this._pathRoot.setAttribute("class"," leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(l){var h=this.getZoomScale(l.zoom),k=this._getCenterOffset(l.center).divideBy(1-1/h),g=this.containerPointToLayerPoint(this.getSize().multiplyBy(-f.Path.CLIP_PADDING)),j=g.add(k).round();this._pathRoot.style[f.DomUtil.TRANSFORM]=f.DomUtil.getTranslateString(j.multiplyBy(-1).add(f.DomUtil.getPosition(this._pathRoot)).multiplyBy(h).add(j))+" scale("+h+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(this._pathZooming){return}this._updatePathViewport();var m=this._pathViewport,j=m.min,l=m.max,h=l.x-j.x,k=l.y-j.y,n=this._pathRoot,g=this._panes.overlayPane;f.Browser.mobileWebkit&&g.removeChild(n),f.DomUtil.setPosition(n,j),n.setAttribute("width",h),n.setAttribute("height",k),n.setAttribute("viewBox",[j.x,j.y,h,k].join(" ")),f.Browser.mobileWebkit&&g.appendChild(n)}}),f.Path.include({bindPopup:function(h,g){if(!this._popup||this._popup.options!==g){this._popup=new f.Popup(g,this)}return this._popup.setContent(h),this._openPopupAdded||(this.on("click",this._openPopup,this),this._openPopupAdded=!0),this},openPopup:function(g){return this._popup&&(g=g||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:g})),this},_openPopup:function(g){this._popup.setLatLng(g.latlng),this._map.openPopup(this._popup)}}),f.Browser.vml=function(){try{var h=document.createElement("div");h.innerHTML='<v:shape adj="1"/>';var g=h.firstChild;return g.style.behavior="url(#default#VML)",g&&typeof g.adj=="object"}catch(j){return !1}}(),f.Path=f.Browser.svg||!f.Browser.vml?f.Path:f.Path.extend({statics:{VML:!0,CLIP_PADDING:0.02},_createElement:function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(h){return document.createElement("<lvml:"+h+' class="lvml">')}}catch(g){return function(h){return document.createElement("<"+h+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var g=this._container=this._createElement("shape");f.DomUtil.addClass(g,"leaflet-vml-shape"),this.options.clickable&&f.DomUtil.addClass(g,"leaflet-clickable"),g.coordsize="1 1",this._path=this._createElement("path"),g.appendChild(this._path),this._map._pathRoot.appendChild(g)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var j=this._stroke,g=this._fill,k=this.options,h=this._container;h.stroked=k.stroke,h.filled=k.fill,k.stroke?(j||(j=this._stroke=this._createElement("stroke"),j.endcap="round",h.appendChild(j)),j.weight=k.weight+"px",j.color=k.color,j.opacity=k.opacity,k.dashArray?j.dashStyle=k.dashArray.replace(/ *, */g," "):j.dashStyle=""):j&&(h.removeChild(j),this._stroke=null),k.fill?(g||(g=this._fill=this._createElement("fill"),h.appendChild(g)),g.color=k.fillColor||k.color,g.opacity=k.fillOpacity):g&&(h.removeChild(g),this._fill=null)},_updatePath:function(){var g=this._container.style;g.display="none",this._path.v=this.getPathString()+" ",g.display=""}}),f.Map.include(f.Browser.svg||!f.Browser.vml?{}:{_initPathRoot:function(){if(this._pathRoot){return}var g=this._pathRoot=document.createElement("div");g.className="leaflet-vml-container",this._panes.overlayPane.appendChild(g),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}),f.Browser.canvas=function(){return !!document.createElement("canvas").getContext}(),f.Path=f.Path.SVG&&!d.L_PREFER_CANVAS||!f.Browser.canvas?f.Path:f.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(g){return f.Util.setOptions(this,g),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(g){g.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this._requestUpdate(),this._map=null},_requestUpdate:function(){this._map&&(f.Util.cancelAnimFrame(this._fireMapMoveEnd),this._updateRequest=f.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var g=this.options;g.stroke&&(this._ctx.lineWidth=g.weight,this._ctx.strokeStyle=g.color),g.fill&&(this._ctx.fillStyle=g.fillColor||g.color)},_drawPath:function(){var l,h,k,g,j,m;this._ctx.beginPath();for(l=0,k=this._parts.length;l<k;l++){for(h=0,g=this._parts[l].length;h<g;h++){j=this._parts[l][h],m=(h===0?"move":"line")+"To",this._ctx[m](j.x,j.y)}this instanceof f.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return !this._parts.length},_updatePath:function(){if(this._checkIfEmpty()){return}var h=this._ctx,g=this.options;this._drawPath(),h.save(),this._updateStyle(),g.fill&&(g.fillOpacity<1&&(h.globalAlpha=g.fillOpacity),h.fill()),g.stroke&&(g.opacity<1&&(h.globalAlpha=g.opacity),h.stroke()),h.restore()},_initEvents:function(){this.options.clickable&&this._map.on("click",this._onClick,this)},_onClick:function(g){this._containsPoint(g.layerPoint)&&this.fire("click",g)}}),f.Map.include(f.Path.SVG&&!d.L_PREFER_CANVAS||!f.Browser.canvas?{}:{_initPathRoot:function(){var h=this._pathRoot,g;h||(h=this._pathRoot=document.createElement("canvas"),h.style.position="absolute",g=this._canvasCtx=h.getContext("2d"),g.lineCap="round",g.lineJoin="round",this._panes.overlayPane.appendChild(h),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(this._pathZooming){return}this._updatePathViewport();var k=this._pathViewport,h=k.min,j=k.max.subtract(h),g=this._pathRoot;f.DomUtil.setPosition(g,h),g.width=j.x,g.height=j.y,g.getContext("2d").translate(-h.x,-h.y)}}),f.LineUtil={simplify:function(h,g){if(!g||!h.length){return h.slice()}var j=g*g;return h=this._reducePoints(h,j),h=this._simplifyDP(h,j),h},pointToSegmentDistance:function(h,g,j){return Math.sqrt(this._sqClosestPointOnSegment(h,g,j,!0))},closestPointOnSegment:function(h,g,j){return this._sqClosestPointOnSegment(h,g,j)},_simplifyDP:function(l,p){var k=l.length,h=typeof Uint8Array!=b+""?Uint8Array:Array,j=new h(k);j[0]=j[k-1]=1,this._simplifyDPStep(l,j,p,0,k-1);var m,g=[];for(m=0;m<k;m++){j[m]&&g.push(l[m])}return g},_simplifyDPStep:function(l,q,j,g,k){var v=0,h,p,m;for(p=g+1;p<=k-1;p++){m=this._sqClosestPointOnSegment(l[p],l[g],l[k],!0),m>v&&(h=p,v=m)}v>j&&(q[h]=1,this._simplifyDPStep(l,q,j,g,h),this._simplifyDPStep(l,q,j,h,k))},_reducePoints:function(l,h){var m=[l[0]];for(var k=1,g=0,j=l.length;k<j;k++){this._sqDist(l[k],l[g])>h&&(m.push(l[k]),g=k)}return g<j-1&&m.push(l[j-1]),m},clipSegment:function(q,x,j,g){var m=j.min,y=j.max,h=g?this._lastCode:this._getBitCode(q,j),w=this._getBitCode(x,j);this._lastCode=w;for(;;){if(!(h|w)){return[q,x]}if(h&w){return !1}var v=h||w,p=this._getEdgeIntersection(q,x,v,j),k=this._getBitCode(p,j);v===h?(q=p,h=k):(x=p,w=k)}},_getEdgeIntersection:function(n,k,m,j){var l=k.x-n.x,p=k.y-n.y,h=j.min,g=j.max;if(m&8){return new f.Point(n.x+l*(g.y-n.y)/p,g.y)}if(m&4){return new f.Point(n.x+l*(h.y-n.y)/p,h.y)}if(m&2){return new f.Point(g.x,n.y+p*(g.x-n.x)/l)}if(m&1){return new f.Point(h.x,n.y+p*(h.x-n.x)/l)}},_getBitCode:function(h,g){var j=0;return h.x<g.min.x?j|=1:h.x>g.max.x&&(j|=2),h.y<g.min.y?j|=4:h.y>g.max.y&&(j|=8),j},_sqDist:function(j,g){var k=g.x-j.x,h=g.y-j.y;return k*k+h*h},_sqClosestPointOnSegment:function(n,v,g,k){var w=v.x,h=v.y,q=g.x-w,p=g.y-h,m=q*q+p*p,j;return m>0&&(j=((n.x-w)*q+(n.y-h)*p)/m,j>1?(w=g.x,h=g.y):j>0&&(w+=q*j,h+=p*j)),q=n.x-w,p=n.y-h,k?q*q+p*p:new f.Point(w,h)}},f.Polyline=f.Path.extend({initialize:function(h,g){f.Path.prototype.initialize.call(this,g),this._latlngs=this._convertLatLngs(h),f.Handler.PolyEdit&&(this.editing=new f.Handler.PolyEdit(this),this.options.editable&&this.editing.enable())},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var h=0,g=this._latlngs.length;h<g;h++){this._originalPoints[h]=this._map.latLngToLayerPoint(this._latlngs[h])}},getPathString:function(){for(var h=0,g=this._parts.length,j="";h<g;h++){j+=this._getPathPartStr(this._parts[h])}return j},getLatLngs:function(){return this._latlngs},setLatLngs:function(g){return this._latlngs=this._convertLatLngs(g),this.redraw()},addLatLng:function(g){return this._latlngs.push(f.latLng(g)),this.redraw()},spliceLatLngs:function(h,g){var j=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs),this.redraw(),j},closestLayerPoint:function(q){var y=Infinity,g=this._parts,m,z,j=null;for(var x=0,w=g.length;x<w;x++){var p=g[x];for(var k=1,v=p.length;k<v;k++){m=p[k-1],z=p[k];var n=f.LineUtil._sqClosestPointOnSegment(q,m,z,!0);n<y&&(y=n,j=f.LineUtil._sqClosestPointOnSegment(q,m,z))}}return j&&(j.distance=Math.sqrt(y)),j},getBounds:function(){var k=new f.LatLngBounds,h=this.getLatLngs();for(var j=0,g=h.length;j<g;j++){k.extend(h[j])}return k},onAdd:function(g){f.Path.prototype.onAdd.call(this,g),this.editing&&this.editing.enabled()&&this.editing.addHooks()},onRemove:function(g){this.editing&&this.editing.enabled()&&this.editing.removeHooks(),f.Path.prototype.onRemove.call(this,g)},_convertLatLngs:function(j){var g,h;for(g=0,h=j.length;g<h;g++){if(j[g] instanceof Array&&typeof j[g][0]!="number"){return}j[g]=f.latLng(j[g])}return j},_initEvents:function(){f.Path.prototype._initEvents.call(this)},_getPathPartStr:function(l){var h=f.Path.VML;for(var k=0,g=l.length,j="",m;k<g;k++){m=l[k],h&&m._round(),j+=(k?"L":"M")+m.x+" "+m.y}return j},_clipPoints:function(){var n=this._originalPoints,k=n.length,m,j,l;if(this.options.noClip){this._parts=[n];return}this._parts=[];var p=this._parts,h=this._map._pathViewport,g=f.LineUtil;for(m=0,j=0;m<k-1;m++){l=g.clipSegment(n[m],n[m+1],h,m);if(!l){continue}p[j]=p[j]||[],p[j].push(l[0]);if(l[1]!==n[m+1]||m===k-2){p[j].push(l[1]),j++}}},_simplifyPoints:function(){var k=this._parts,h=f.LineUtil;for(var j=0,g=k.length;j<g;j++){k[j]=h.simplify(k[j],this.options.smoothFactor)}},_updatePath:function(){if(!this._map){return}this._clipPoints(),this._simplifyPoints(),f.Path.prototype._updatePath.call(this)}}),f.polyline=function(h,g){return new f.Polyline(h,g)},f.PolyUtil={},f.PolyUtil.clipPolygon=function(x,D){var g=D.min,n=D.max,E,k=[1,4,2,8],C,A,w,m,z,q,j,y,B=f.LineUtil;for(C=0,q=x.length;C<q;C++){x[C]._code=B._getBitCode(x[C],D)}for(w=0;w<4;w++){j=k[w],E=[];for(C=0,q=x.length,A=q-1;C<q;A=C++){m=x[C],z=x[A],m._code&j?z._code&j||(y=B._getEdgeIntersection(z,m,j,D),y._code=B._getBitCode(y,D),E.push(y)):(z._code&j&&(y=B._getEdgeIntersection(z,m,j,D),y._code=B._getBitCode(y,D),E.push(y)),E.push(m))}x=E}return x},f.Polygon=f.Polyline.extend({options:{fill:!0},initialize:function(h,g){f.Polyline.prototype.initialize.call(this,h,g),h&&h[0] instanceof Array&&typeof h[0][0]!="number"&&(this._latlngs=this._convertLatLngs(h[0]),this._holes=h.slice(1))},projectLatlngs:function(){f.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[];if(!this._holes){return}for(var l=0,h=this._holes.length,k;l<h;l++){this._holePoints[l]=[];for(var g=0,j=this._holes[l].length;g<j;g++){this._holePoints[l][g]=this._map.latLngToLayerPoint(this._holes[l][g])}}},_clipPoints:function(){var l=this._originalPoints,h=[];this._parts=[l].concat(this._holePoints);if(this.options.noClip){return}for(var k=0,g=this._parts.length;k<g;k++){var j=f.PolyUtil.clipPolygon(this._parts[k],this._map._pathViewport);if(!j.length){continue}h.push(j)}this._parts=h},_getPathPartStr:function(h){var g=f.Polyline.prototype._getPathPartStr.call(this,h);return g+(f.Browser.svg?"z":"x")}}),f.polygon=function(h,g){return new f.Polygon(h,g)},function(){function g(h){return f.FeatureGroup.extend({initialize:function(k,j){this._layers={},this._options=j,this.setLatLngs(k)},setLatLngs:function(e){var k=0,j=e.length;this.eachLayer(function(l){k<j?l.setLatLngs(e[k++]):this.removeLayer(l)},this);while(k<j){this.addLayer(new h(e[k++],this._options))}return this}})}f.MultiPolyline=g(f.Polyline),f.MultiPolygon=g(f.Polygon),f.multiPolyline=function(j,h){return new f.MultiPolyline(j,h)},f.multiPolygon=function(j,h){return new f.MultiPolygon(j,h)}}(),f.Rectangle=f.Polygon.extend({initialize:function(h,g){f.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(h),g)},setBounds:function(g){this.setLatLngs(this._boundsToLatLngs(g))},_boundsToLatLngs:function(g){return g=f.latLngBounds(g),[g.getSouthWest(),g.getNorthWest(),g.getNorthEast(),g.getSouthEast(),g.getSouthWest()]}}),f.rectangle=function(h,g){return new f.Rectangle(h,g)},f.Circle=f.Path.extend({initialize:function(j,g,h){f.Path.prototype.initialize.call(this,h),this._latlng=f.latLng(j),this._mRadius=g},options:{fill:!0},setLatLng:function(g){return this._latlng=f.latLng(g),this.redraw()},setRadius:function(g){return this._mRadius=g,this.redraw()},projectLatlngs:function(){var j=this._getLngRadius(),g=new f.LatLng(this._latlng.lat,this._latlng.lng-j,!0),h=this._map.latLngToLayerPoint(g);this._point=this._map.latLngToLayerPoint(this._latlng),this._radius=Math.max(Math.round(this._point.x-h.x),1)},getBounds:function(){var m=this._map,j=this._radius*Math.cos(Math.PI/4),l=m.project(this._latlng),h=new f.Point(l.x-j,l.y+j),k=new f.Point(l.x+j,l.y-j),n=m.unproject(h),g=m.unproject(k);return new f.LatLngBounds(n,g)},getLatLng:function(){return this._latlng},getPathString:function(){var h=this._point,g=this._radius;return this._checkIfEmpty()?"":f.Browser.svg?"M"+h.x+","+(h.y-g)+"A"+g+","+g+",0,1,1,"+(h.x-0.1)+","+(h.y-g)+" z":(h._round(),g=Math.round(g),"AL "+h.x+","+h.y+" "+g+","+g+" 0,"+23592600)},getRadius:function(){return this._mRadius},_getLngRadius:function(){var h=40075017,g=h*Math.cos(f.LatLng.DEG_TO_RAD*this._latlng.lat);return this._mRadius/g*360},_checkIfEmpty:function(){if(!this._map){return !1}var h=this._map._pathViewport,g=this._radius,j=this._point;return j.x-g>h.max.x||j.y-g>h.max.y||j.x+g<h.min.x||j.y+g<h.min.y}}),f.circle=function(j,g,h){return new f.Circle(j,g,h)},f.CircleMarker=f.Circle.extend({options:{radius:10,weight:2},initialize:function(h,g){f.Circle.prototype.initialize.call(this,h,null,g),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},setRadius:function(g){return this._radius=g,this.redraw()}}),f.circleMarker=function(h,g){return new f.CircleMarker(h,g)},f.Polyline.include(f.Path.CANVAS?{_containsPoint:function(n,v){var g,k,w,h,q,p,m,j=this.options.weight/2;f.Browser.touch&&(j+=10);for(g=0,h=this._parts.length;g<h;g++){m=this._parts[g];for(k=0,q=m.length,w=q-1;k<q;w=k++){if(!v&&k===0){continue}p=f.LineUtil.pointToSegmentDistance(n,m[w],m[k]);if(p<=j){return !0}}}return !1}}:{}),f.Polygon.include(f.Path.CANVAS?{_containsPoint:function(n){var v=!1,g,k,w,h,q,p,m,j;if(f.Polyline.prototype._containsPoint.call(this,n,!0)){return !0}for(h=0,m=this._parts.length;h<m;h++){g=this._parts[h];for(q=0,j=g.length,p=j-1;q<j;p=q++){k=g[q],w=g[p],k.y>n.y!=w.y>n.y&&n.x<(w.x-k.x)*(n.y-k.y)/(w.y-k.y)+k.x&&(v=!v)}}return v}}:{}),f.Circle.include(f.Path.CANVAS?{_drawPath:function(){var g=this._point;this._ctx.beginPath(),this._ctx.arc(g.x,g.y,this._radius,0,Math.PI*2,!1)},_containsPoint:function(h){var g=this._point,j=this.options.stroke?this.options.weight/2:0;return h.distanceTo(g)<=this._radius+j}}:{}),f.GeoJSON=f.FeatureGroup.extend({initialize:function(h,g){f.Util.setOptions(this,g),this._layers={},h&&this.addData(h)},addData:function(l){var h=l instanceof Array?l:l.features,k,g;if(h){for(k=0,g=h.length;k<g;k++){this.addData(h[k])}return this}var j=this.options;if(j.filter&&!j.filter(l)){return}var m=f.GeoJSON.geometryToLayer(l,j.pointToLayer);return m.feature=l,this.resetStyle(m),j.onEachFeature&&j.onEachFeature(l,m),this.addLayer(m)},resetStyle:function(h){var g=this.options.style;g&&this._setLayerStyle(h,g)},setStyle:function(g){this.eachLayer(function(e){this._setLayerStyle(e,g)},this)},_setLayerStyle:function(h,g){typeof g=="function"&&(g=g(h.feature)),h.setStyle&&h.setStyle(g)}}),f.Util.extend(f.GeoJSON,{geometryToLayer:function(n,v){var g=n.type==="Feature"?n.geometry:n,k=g.coordinates,w=[],h,q,p,m,j;switch(g.type){case"Point":return h=this.coordsToLatLng(k),v?v(n,h):new f.Marker(h);case"MultiPoint":for(p=0,m=k.length;p<m;p++){h=this.coordsToLatLng(k[p]),j=v?v(n,h):new f.Marker(h),w.push(j)}return new f.FeatureGroup(w);case"LineString":return q=this.coordsToLatLngs(k),new f.Polyline(q);case"Polygon":return q=this.coordsToLatLngs(k,1),new f.Polygon(q);case"MultiLineString":return q=this.coordsToLatLngs(k,1),new f.MultiPolyline(q);case"MultiPolygon":return q=this.coordsToLatLngs(k,2),new f.MultiPolygon(q);case"GeometryCollection":for(p=0,m=g.geometries.length;p<m;p++){j=this.geometryToLayer(g.geometries[p],v),w.push(j)}return new f.FeatureGroup(w);default:throw Error("Invalid GeoJSON object.")}},coordsToLatLng:function(k,h){var j=parseFloat(k[h?0:1]),g=parseFloat(k[h?1:0]);return new f.LatLng(j,g,!0)},coordsToLatLngs:function(l,h,p){var k,g=[],j,m;for(j=0,m=l.length;j<m;j++){k=h?this.coordsToLatLngs(l[j],h-1,p):this.coordsToLatLng(l[j],p),g.push(k)}return g}}),f.geoJson=function(h,g){return new f.GeoJSON(h,g)},f.DomEvent={addListener:function(l,p,g,j){var q=f.Util.stamp(g),h="_leaflet_"+p+q,n,m,k;return l[h]?this:(n=function(e){return g.call(j||l,e||f.DomEvent._getEvent())},f.Browser.touch&&p==="dblclick"&&this.addDoubleTapListener?this.addDoubleTapListener(l,n,q):("addEventListener" in l?p==="mousewheel"?(l.addEventListener("DOMMouseScroll",n,!1),l.addEventListener(p,n,!1)):p==="mouseenter"||p==="mouseleave"?(m=n,k=p==="mouseenter"?"mouseover":"mouseout",n=function(e){if(!f.DomEvent._checkMouse(l,e)){return}return m(e)},l.addEventListener(k,n,!1)):l.addEventListener(p,n,!1):"attachEvent" in l&&l.attachEvent("on"+p,n),l[h]=n,this))},removeListener:function(l,h,k){var g=f.Util.stamp(k),j="_leaflet_"+h+g,m=l[j];if(!m){return}return f.Browser.touch&&h==="dblclick"&&this.removeDoubleTapListener?this.removeDoubleTapListener(l,g):"removeEventListener" in l?h==="mousewheel"?(l.removeEventListener("DOMMouseScroll",m,!1),l.removeEventListener(h,m,!1)):h==="mouseenter"||h==="mouseleave"?l.removeEventListener(h==="mouseenter"?"mouseover":"mouseout",m,!1):l.removeEventListener(h,m,!1):"detachEvent" in l&&l.detachEvent("on"+h,m),l[j]=null,this},stopPropagation:function(g){return g.stopPropagation?g.stopPropagation():g.cancelBubble=!0,this},disableClickPropagation:function(h){var g=f.DomEvent.stopPropagation;return f.DomEvent.addListener(h,f.Draggable.START,g).addListener(h,"click",g).addListener(h,"dblclick",g)},preventDefault:function(g){return g.preventDefault?g.preventDefault():g.returnValue=!1,this},stop:function(g){return f.DomEvent.preventDefault(g).stopPropagation(g)},getMousePosition:function(m,j){var l=document.body,h=document.documentElement,k=m.pageX?m.pageX:m.clientX+l.scrollLeft+h.scrollLeft,n=m.pageY?m.pageY:m.clientY+l.scrollTop+h.scrollTop,g=new f.Point(k,n);return j?g._subtract(f.DomUtil.getViewportOffset(j)):g},getWheelDelta:function(h){var g=0;return h.wheelDelta&&(g=h.wheelDelta/120),h.detail&&(g=-h.detail/3),g},_checkMouse:function(j,g){var k=g.relatedTarget;if(!k){return !0}try{while(k&&k!==j){k=k.parentNode}}catch(h){return !1}return k!==j},_getEvent:function(){var e=d.event;if(!e){var g=arguments.callee.caller;while(g){e=g.arguments[0];if(e&&d.Event===e.constructor){break}g=g.caller}}return e}},f.DomEvent.on=f.DomEvent.addListener,f.DomEvent.off=f.DomEvent.removeListener,f.Draggable=f.Class.extend({includes:f.Mixin.Events,statics:{START:f.Browser.touch?"touchstart":"mousedown",END:f.Browser.touch?"touchend":"mouseup",MOVE:f.Browser.touch?"touchmove":"mousemove",TAP_TOLERANCE:15},initialize:function(h,g){this._element=h,this._dragStartTarget=g||h},enable:function(){if(this._enabled){return}f.DomEvent.on(this._dragStartTarget,f.Draggable.START,this._onDown,this),this._enabled=!0},disable:function(){if(!this._enabled){return}f.DomEvent.off(this._dragStartTarget,f.Draggable.START,this._onDown),this._enabled=!1,this._moved=!1},_onDown:function(j){if(!f.Browser.touch&&j.shiftKey||j.which!==1&&j.button!==1&&!j.touches){return}this._simulateClick=!0;if(j.touches&&j.touches.length>1){this._simulateClick=!1;return}var g=j.touches&&j.touches.length===1?j.touches[0]:j,h=g.target;f.DomEvent.preventDefault(j),f.Browser.touch&&h.tagName.toLowerCase()==="a"&&f.DomUtil.addClass(h,"leaflet-active"),this._moved=!1;if(this._moving){return}this._startPos=this._newPos=f.DomUtil.getPosition(this._element),this._startPoint=new f.Point(g.clientX,g.clientY),f.DomEvent.on(document,f.Draggable.MOVE,this._onMove,this),f.DomEvent.on(document,f.Draggable.END,this._onUp,this)},_onMove:function(k){if(k.touches&&k.touches.length>1){return}var h=k.touches&&k.touches.length===1?k.touches[0]:k,j=new f.Point(h.clientX,h.clientY),g=j.subtract(this._startPoint);if(!g.x&&!g.y){return}f.DomEvent.preventDefault(k),this._moved||(this.fire("dragstart"),this._moved=!0,f.Browser.touch||(f.DomUtil.disableTextSelection(),this._setMovingCursor())),this._newPos=this._startPos.add(g),this._moving=!0,f.Util.cancelAnimFrame(this._animRequest),this._animRequest=f.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)},_updatePosition:function(){this.fire("predrag"),f.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(k){if(this._simulateClick&&k.changedTouches){var h=k.changedTouches[0],j=h.target,g=this._newPos&&this._newPos.distanceTo(this._startPos)||0;j.tagName.toLowerCase()==="a"&&f.DomUtil.removeClass(j,"leaflet-active"),g<f.Draggable.TAP_TOLERANCE&&this._simulateEvent("click",h)}f.Browser.touch||(f.DomUtil.enableTextSelection(),this._restoreCursor()),f.DomEvent.off(document,f.Draggable.MOVE,this._onMove),f.DomEvent.off(document,f.Draggable.END,this._onUp),this._moved&&(f.Util.cancelAnimFrame(this._animRequest),this.fire("dragend")),this._moving=!1},_setMovingCursor:function(){f.DomUtil.addClass(document.body,"leaflet-dragging")},_restoreCursor:function(){f.DomUtil.removeClass(document.body,"leaflet-dragging")},_simulateEvent:function(e,h){var g=document.createEvent("MouseEvents");g.initMouseEvent(e,!0,!0,d,1,h.screenX,h.screenY,h.clientX,h.clientY,!1,!1,!1,!1,0,null),h.target.dispatchEvent(g)}}),f.Handler=f.Class.extend({initialize:function(g){this._map=g},enable:function(){if(this._enabled){return}this._enabled=!0,this.addHooks()},disable:function(){if(!this._enabled){return}this._enabled=!1,this.removeHooks()},enabled:function(){return !!this._enabled}}),f.Map.mergeOptions({dragging:!0,inertia:!f.Browser.android23,inertiaDeceleration:3000,inertiaMaxSpeed:1500,inertiaThreshold:f.Browser.touch?32:14,worldCopyJump:!0}),f.Map.Drag=f.Handler.extend({addHooks:function(){if(!this._draggable){this._draggable=new f.Draggable(this._map._mapPane,this._map._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);var g=this._map.options;g.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),this._map.on("viewreset",this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var g=this._map;g.fire("movestart").fire("dragstart"),g._panTransition&&g._panTransition._onTransitionEnd(!0),g.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var h=this._lastTime=+(new Date),g=this._lastPos=this._draggable._newPos;this._positions.push(g),this._times.push(h),h-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var h=this._map.getSize().divideBy(2),g=this._map.latLngToLayerPoint(new f.LatLng(0,0));this._initialWorldOffset=g.subtract(h).x,this._worldWidth=this._map.project(new f.LatLng(0,180)).x},_onPreDrag:function(){var m=this._map,j=this._worldWidth,q=Math.round(j/2),l=this._initialWorldOffset,h=this._draggable._newPos.x,k=(h-q+l)%j+q-l,p=(h+q+l)%j-q-l,g=Math.abs(k+l)<Math.abs(p+l)?k:p;this._draggable._newPos.x=g},_onDragEnd:function(){var v=this._map,g=v.options,n=+(new Date)-this._lastTime,A=!g.inertia||n>g.inertiaThreshold||this._positions[0]===b;if(A){v.fire("moveend")}else{var k=this._lastPos.subtract(this._positions[0]),z=(this._lastTime+n-this._times[0])/1000,y=k.multiplyBy(0.58/z),t=y.distanceTo(new f.Point(0,0)),m=Math.min(g.inertiaMaxSpeed,t),x=y.multiplyBy(m/t),q=m/g.inertiaDeceleration,j=x.multiplyBy(-q/2).round(),w={duration:q,easing:"ease-out"};f.Util.requestAnimFrame(f.Util.bind(function(){this._map.panBy(j,w)},this))}v.fire("dragend"),g.maxBounds&&f.Util.requestAnimFrame(this._panInsideMaxBounds,v,!0,v._container)},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)}}),f.Map.addInitHook("addHandler","dragging",f.Map.Drag),f.Map.mergeOptions({doubleClickZoom:!0}),f.Map.DoubleClickZoom=f.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick)},_onDoubleClick:function(g){this.setView(g.latlng,this._zoom+1)}}),f.Map.addInitHook("addHandler","doubleClickZoom",f.Map.DoubleClickZoom),f.Map.mergeOptions({scrollWheelZoom:!f.Browser.touch}),f.Map.ScrollWheelZoom=f.Handler.extend({addHooks:function(){f.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){f.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll)},_onWheelScroll:function(h){var g=f.DomEvent.getWheelDelta(h);this._delta+=g,this._lastMousePos=this._map.mouseEventToContainerPoint(h),clearTimeout(this._timer),this._timer=setTimeout(f.Util.bind(this._performZoom,this),40),f.DomEvent.preventDefault(h)},_performZoom:function(){var k=this._map,h=Math.round(this._delta),l=k.getZoom();h=Math.max(Math.min(h,4),-4),h=k._limitZoom(l+h)-l,this._delta=0;if(!h){return}var j=l+h,g=this._getCenterForScrollWheelZoom(this._lastMousePos,j);k.setView(g,j)},_getCenterForScrollWheelZoom:function(l,h){var p=this._map,k=p.getZoomScale(h),g=p.getSize().divideBy(2),j=l.subtract(g).multiplyBy(1-1/k),m=p._getTopLeftPoint().add(g).add(j);return p.unproject(m)}}),f.Map.addInitHook("addHandler","scrollWheelZoom",f.Map.ScrollWheelZoom),f.Util.extend(f.DomEvent,{addDoubleTapListener:function(q,y,j){function k(o){if(o.touches.length!==1){return}var l=Date.now(),r=l-(g||l);h=o.touches[0],m=r>0&&r<=z,g=l}function v(l){m&&(h.type="dblclick",y(h),g=null)}var g,m=!1,z=250,h,x="_leaflet_",w="touchstart",p="touchend";return q[x+w+j]=k,q[x+p+j]=v,q.addEventListener(w,k,!1),q.addEventListener(p,v,!1),this},removeDoubleTapListener:function(h,g){var j="_leaflet_";return h.removeEventListener(h,h[j+"touchstart"+g],!1),h.removeEventListener(h,h[j+"touchend"+g],!1),this}}),f.Map.mergeOptions({touchZoom:f.Browser.touch&&!f.Browser.android23}),f.Map.TouchZoom=f.Handler.extend({addHooks:function(){f.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){f.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(l){var h=this._map;if(!l.touches||l.touches.length!==2||h._animatingZoom||this._zooming){return}var k=h.mouseEventToLayerPoint(l.touches[0]),g=h.mouseEventToLayerPoint(l.touches[1]),j=h._getCenterLayerPoint();this._startCenter=k.add(g).divideBy(2,!0),this._startDist=k.distanceTo(g),this._moved=!1,this._zooming=!0,this._centerOffset=j.subtract(this._startCenter),f.DomEvent.on(document,"touchmove",this._onTouchMove,this).on(document,"touchend",this._onTouchEnd,this),f.DomEvent.preventDefault(l)},_onTouchMove:function(k){if(!k.touches||k.touches.length!==2){return}var h=this._map,j=h.mouseEventToLayerPoint(k.touches[0]),g=h.mouseEventToLayerPoint(k.touches[1]);this._scale=j.distanceTo(g)/this._startDist,this._delta=j.add(g).divideBy(2,!0).subtract(this._startCenter);if(this._scale===1){return}this._moved||(f.DomUtil.addClass(h._mapPane,"leaflet-zoom-anim leaflet-touching"),h.fire("movestart").fire("zoomstart")._prepareTileBg(),this._moved=!0),f.Util.cancelAnimFrame(this._animRequest),this._animRequest=f.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),f.DomEvent.preventDefault(k)},_updateOnMove:function(){var j=this._map,g=this._getScaleOrigin(),h=j.layerPointToLatLng(g);j.fire("zoomanim",{center:h,zoom:j.getScaleZoom(this._scale)}),j._tileBg.style[f.DomUtil.TRANSFORM]=f.DomUtil.getTranslateString(this._delta)+" "+f.DomUtil.getScaleString(this._scale,this._startCenter)},_onTouchEnd:function(n){if(!this._moved||!this._zooming){return}var k=this._map;this._zooming=!1,f.DomUtil.removeClass(k._mapPane,"leaflet-touching"),f.DomEvent.off(document,"touchmove",this._onTouchMove).off(document,"touchend",this._onTouchEnd);var m=this._getScaleOrigin(),j=k.layerPointToLatLng(m),l=k.getZoom(),p=k.getScaleZoom(this._scale)-l,h=p>0?Math.ceil(p):Math.floor(p),g=k._limitZoom(l+h);k.fire("zoomanim",{center:j,zoom:g}),k._runAnimation(j,g,k.getZoomScale(g)/this._scale,m,!0)},_getScaleOrigin:function(){var g=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(g)}}),f.Map.addInitHook("addHandler","touchZoom",f.Map.TouchZoom),f.Map.mergeOptions({boxZoom:!0}),f.Map.BoxZoom=f.Handler.extend({initialize:function(g){this._map=g,this._container=g._container,this._pane=g._panes.overlayPane},addHooks:function(){f.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){f.DomEvent.off(this._container,"mousedown",this._onMouseDown)},_onMouseDown:function(g){if(!g.shiftKey||g.which!==1&&g.button!==1){return !1}f.DomUtil.disableTextSelection(),this._startLayerPoint=this._map.mouseEventToLayerPoint(g),this._box=f.DomUtil.create("div","leaflet-zoom-box",this._pane),f.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",f.DomEvent.on(document,"mousemove",this._onMouseMove,this).on(document,"mouseup",this._onMouseUp,this).preventDefault(g),this._map.fire("boxzoomstart")},_onMouseMove:function(l){var h=this._startLayerPoint,k=this._box,g=this._map.mouseEventToLayerPoint(l),j=g.subtract(h),m=new f.Point(Math.min(g.x,h.x),Math.min(g.y,h.y));f.DomUtil.setPosition(k,m),k.style.width=Math.abs(j.x)-4+"px",k.style.height=Math.abs(j.y)-4+"px"},_onMouseUp:function(k){this._pane.removeChild(this._box),this._container.style.cursor="",f.DomUtil.enableTextSelection(),f.DomEvent.off(document,"mousemove",this._onMouseMove).off(document,"mouseup",this._onMouseUp);var h=this._map,j=h.mouseEventToLayerPoint(k),g=new f.LatLngBounds(h.layerPointToLatLng(this._startLayerPoint),h.layerPointToLatLng(j));h.fitBounds(g),h.fire("boxzoomend",{boxZoomBounds:g})}}),f.Map.addInitHook("addHandler","boxZoom",f.Map.BoxZoom),f.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),f.Map.Keyboard=f.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61],zoomOut:[189,109]},initialize:function(g){this._map=g,this._setPanOffset(g.options.keyboardPanOffset),this._setZoomOffset(g.options.keyboardZoomOffset)},addHooks:function(){var g=this._map._container;g.tabIndex===-1&&(g.tabIndex="0"),f.DomEvent.addListener(g,"focus",this._onFocus,this).addListener(g,"blur",this._onBlur,this).addListener(g,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var g=this._map._container;f.DomEvent.removeListener(g,"focus",this._onFocus,this).removeListener(g,"blur",this._onBlur,this).removeListener(g,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){this._focused||this._map._container.focus()},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(k){var h=this._panKeys={},l=this.keyCodes,j,g;for(j=0,g=l.left.length;j<g;j++){h[l.left[j]]=[-1*k,0]}for(j=0,g=l.right.length;j<g;j++){h[l.right[j]]=[k,0]}for(j=0,g=l.down.length;j<g;j++){h[l.down[j]]=[0,k]}for(j=0,g=l.up.length;j<g;j++){h[l.up[j]]=[0,-1*k]}},_setZoomOffset:function(k){var h=this._zoomKeys={},l=this.keyCodes,j,g;for(j=0,g=l.zoomIn.length;j<g;j++){h[l.zoomIn[j]]=k}for(j=0,g=l.zoomOut.length;j<g;j++){h[l.zoomOut[j]]=-k}},_addHooks:function(){f.DomEvent.addListener(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){f.DomEvent.removeListener(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(h){var g=h.keyCode;if(this._panKeys.hasOwnProperty(g)){this._map.panBy(this._panKeys[g])}else{if(!this._zoomKeys.hasOwnProperty(g)){return}this._map.setZoom(this._map.getZoom()+this._zoomKeys[g])}f.DomEvent.stop(h)}}),f.Map.addInitHook("addHandler","keyboard",f.Map.Keyboard),f.Handler.MarkerDrag=f.Handler.extend({initialize:function(g){this._marker=g},addHooks:function(){var g=this._marker._icon;this._draggable||(this._draggable=(new f.Draggable(g,g)).on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this)),this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(g){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(h){var g=f.DomUtil.getPosition(this._marker._icon);this._marker._shadow&&f.DomUtil.setPosition(this._marker._shadow,g),this._marker._latlng=this._marker._map.layerPointToLatLng(g),this._marker.fire("move").fire("drag")},_onDragEnd:function(){this._marker.fire("moveend").fire("dragend")}}),f.Handler.PolyEdit=f.Handler.extend({options:{icon:new f.DivIcon({iconSize:new f.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"})},initialize:function(h,g){this._poly=h,f.Util.setOptions(this,g)},addHooks:function(){this._poly._map&&(this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){this._poly._map&&(this._poly._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new f.LayerGroup),this._markers=[];var m=this._poly._latlngs,j,l,h,k;for(j=0,h=m.length;j<h;j++){k=this._createMarker(m[j],j),k.on("click",this._onMarkerClick,this),this._markers.push(k)}var n,g;for(j=0,l=h-1;j<h;l=j++){if(j===0&&!(f.Polygon&&this._poly instanceof f.Polygon)){continue}n=this._markers[l],g=this._markers[j],this._createMiddleMarker(n,g),this._updatePrevNext(n,g)}},_createMarker:function(j,g){var h=new f.Marker(j,{draggable:!0,icon:this.options.icon});return h._origLatLng=j,h._index=g,h.on("drag",this._onMarkerDrag,this),h.on("dragend",this._fireEdit,this),this._markerGroup.addLayer(h),h},_fireEdit:function(){this._poly.fire("edit")},_onMarkerDrag:function(h){var g=h.target;f.Util.extend(g._origLatLng,g._latlng),g._middleLeft&&g._middleLeft.setLatLng(this._getMiddleLatLng(g._prev,g)),g._middleRight&&g._middleRight.setLatLng(this._getMiddleLatLng(g,g._next)),this._poly.redraw()},_onMarkerClick:function(h){if(this._poly._latlngs.length<3){return}var g=h.target,j=g._index;g._prev&&g._next&&(this._createMiddleMarker(g._prev,g._next),this._updatePrevNext(g._prev,g._next)),this._markerGroup.removeLayer(g),g._middleLeft&&this._markerGroup.removeLayer(g._middleLeft),g._middleRight&&this._markerGroup.removeLayer(g._middleRight),this._markers.splice(j,1),this._poly.spliceLatLngs(j,1),this._updateIndexes(j,-1),this._poly.fire("edit")},_updateIndexes:function(h,g){this._markerGroup.eachLayer(function(e){e._index>h&&(e._index+=g)})},_createMiddleMarker:function(l,h){var p=this._getMiddleLatLng(l,h),k=this._createMarker(p),g,j,m;k.setOpacity(0.6),l._middleRight=h._middleLeft=k,j=function(){var e=h._index;k._index=e,k.off("click",g).on("click",this._onMarkerClick,this),p.lat=k.getLatLng().lat,p.lng=k.getLatLng().lng,this._poly.spliceLatLngs(e,0,p),this._markers.splice(e,0,k),k.setOpacity(1),this._updateIndexes(e,1),h._index++,this._updatePrevNext(l,k),this._updatePrevNext(k,h)},m=function(){k.off("dragstart",j,this),k.off("dragend",m,this),this._createMiddleMarker(l,k),this._createMiddleMarker(k,h)},g=function(){j.call(this),m.call(this),this._poly.fire("edit")},k.on("click",g,this).on("dragstart",j,this).on("dragend",m,this),this._markerGroup.addLayer(k)},_updatePrevNext:function(h,g){h._next=g,g._prev=h},_getMiddleLatLng:function(k,h){var l=this._poly._map,j=l.latLngToLayerPoint(k.getLatLng()),g=l.latLngToLayerPoint(h.getLatLng());return l.layerPointToLatLng(j._add(g).divideBy(2))}}),f.Control=f.Class.extend({options:{position:"topright"},initialize:function(g){f.Util.setOptions(this,g)},getPosition:function(){return this.options.position},setPosition:function(h){var g=this._map;return g&&g.removeControl(this),this.options.position=h,g&&g.addControl(this),this},addTo:function(k){this._map=k;var h=this._container=this.onAdd(k),j=this.getPosition(),g=k._controlCorners[j];return f.DomUtil.addClass(h,"leaflet-control"),j.indexOf("bottom")!==-1?g.insertBefore(h,g.firstChild):g.appendChild(h),this},removeFrom:function(h){var g=this.getPosition(),j=h._controlCorners[g];return j.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(h),this}}),f.control=function(g){return new f.Control(g)},f.Map.include({addControl:function(g){return g.addTo(this),this},removeControl:function(g){return g.removeFrom(this),this},_initControlPos:function(){function h(e,l){var m=g+e+" "+g+l;k[e+l]=f.DomUtil.create("div",m,j)}var k=this._controlCorners={},g="leaflet-",j=this._controlContainer=f.DomUtil.create("div",g+"control-container",this._container);h("top","left"),h("top","right"),h("bottom","left"),h("bottom","right")}}),f.Control.Zoom=f.Control.extend({options:{position:"topleft"},onAdd:function(j){var g="leaflet-control-zoom",h=f.DomUtil.create("div",g);return this._createButton("Zoom in",g+"-in",h,j.zoomIn,j),this._createButton("Zoom out",g+"-out",h,j.zoomOut,j),h},_createButton:function(l,h,k,g,j){var m=f.DomUtil.create("a",h,k);return m.href="#",m.title=l,f.DomEvent.on(m,"click",f.DomEvent.stopPropagation).on(m,"click",f.DomEvent.preventDefault).on(m,"click",g,j).on(m,"dblclick",f.DomEvent.stopPropagation),m}}),f.Map.mergeOptions({zoomControl:!0}),f.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new f.Control.Zoom,this.addControl(this.zoomControl))}),f.control.zoom=function(g){return new f.Control.Zoom(g)},f.Control.Attribution=f.Control.extend({options:{position:"bottomright",prefix:'Powered by <a href="http://leaflet.cloudmade.com">Leaflet</a>'},initialize:function(g){f.Util.setOptions(this,g),this._attributions={}},onAdd:function(g){return this._container=f.DomUtil.create("div","leaflet-control-attribution"),f.DomEvent.disableClickPropagation(this._container),g.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(g){g.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(g){return this.options.prefix=g,this._update(),this},addAttribution:function(g){if(!g){return}return this._attributions[g]||(this._attributions[g]=0),this._attributions[g]++,this._update(),this},removeAttribution:function(g){if(!g){return}return this._attributions[g]--,this._update(),this},_update:function(){if(!this._map){return}var h=[];for(var g in this._attributions){this._attributions.hasOwnProperty(g)&&this._attributions[g]&&h.push(g)}var j=[];this.options.prefix&&j.push(this.options.prefix),h.length&&j.push(h.join(", ")),this._container.innerHTML=j.join(" &#8212; ")},_onLayerAdd:function(g){g.layer.getAttribution&&this.addAttribution(g.layer.getAttribution())},_onLayerRemove:function(g){g.layer.getAttribution&&this.removeAttribution(g.layer.getAttribution())}}),f.Map.mergeOptions({attributionControl:!0}),f.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new f.Control.Attribution).addTo(this))}),f.control.attribution=function(g){return new f.Control.Attribution(g)},f.Control.Scale=f.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(k){this._map=k;var h="leaflet-control-scale",j=f.DomUtil.create("div",h),g=this.options;return this._addScales(g,h,j),k.on(g.updateWhenIdle?"moveend":"move",this._update,this),this._update(),j},onRemove:function(g){g.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(j,g,h){j.metric&&(this._mScale=f.DomUtil.create("div",g+"-line",h)),j.imperial&&(this._iScale=f.DomUtil.create("div",g+"-line",h))},_update:function(){var l=this._map.getBounds(),h=l.getCenter().lat,p=6378137*Math.PI*Math.cos(h*Math.PI/180),k=p*(l.getNorthEast().lng-l.getSouthWest().lng)/180,g=this._map.getSize(),j=this.options,m=0;g.x>0&&(m=k*(j.maxWidth/g.x)),this._updateScales(j,m)},_updateScales:function(h,g){h.metric&&g&&this._updateMetric(g),h.imperial&&g&&this._updateImperial(g)},_updateMetric:function(h){var g=this._getRoundNum(h);this._mScale.style.width=this._getScaleWidth(g/h)+"px",this._mScale.innerHTML=g<1000?g+" m":g/1000+" km"},_updateImperial:function(l){var h=l*3.2808399,m=this._iScale,k,g,j;h>5280?(k=h/5280,g=this._getRoundNum(k),m.style.width=this._getScaleWidth(g/k)+"px",m.innerHTML=g+" mi"):(j=this._getRoundNum(h),m.style.width=this._getScaleWidth(j/h)+"px",m.innerHTML=j+" ft")},_getScaleWidth:function(g){return Math.round(this.options.maxWidth*g)-10},_getRoundNum:function(h){var g=Math.pow(10,(Math.floor(h)+"").length-1),j=h/g;return j=j>=10?10:j>=5?5:j>=3?3:j>=2?2:1,g*j}}),f.control.scale=function(g){return new f.Control.Scale(g)},f.Control.Layers=f.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(k,h,j){f.Util.setOptions(this,j),this._layers={},this._lastZIndex=0;for(var g in k){k.hasOwnProperty(g)&&this._addLayer(k[g],g)}for(g in h){h.hasOwnProperty(g)&&this._addLayer(h[g],g,!0)}},onAdd:function(g){return this._initLayout(),this._update(),this._container},addBaseLayer:function(h,g){return this._addLayer(h,g),this._update(),this},addOverlay:function(h,g){return this._addLayer(h,g,!0),this._update(),this},removeLayer:function(h){var g=f.Util.stamp(h);return delete this._layers[g],this._update(),this},_initLayout:function(){var k="leaflet-control-layers",h=this._container=f.DomUtil.create("div",k);f.Browser.touch?f.DomEvent.on(h,"click",f.DomEvent.stopPropagation):f.DomEvent.disableClickPropagation(h);var j=this._form=f.DomUtil.create("form",k+"-list");if(this.options.collapsed){f.DomEvent.on(h,"mouseover",this._expand,this).on(h,"mouseout",this._collapse,this);var g=this._layersLink=f.DomUtil.create("a",k+"-toggle",h);g.href="#",g.title="Layers",f.Browser.touch?f.DomEvent.on(g,"click",f.DomEvent.stopPropagation).on(g,"click",f.DomEvent.preventDefault).on(g,"click",this._expand,this):f.DomEvent.on(g,"focus",this._expand,this),this._map.on("movestart",this._collapse,this)}else{this._expand()}this._baseLayersList=f.DomUtil.create("div",k+"-base",j),this._separator=f.DomUtil.create("div",k+"-separator",j),this._overlaysList=f.DomUtil.create("div",k+"-overlays",j),h.appendChild(j)},_addLayer:function(k,h,j){var g=f.Util.stamp(k);this._layers[g]={layer:k,name:h,overlay:j},this.options.autoZIndex&&k.setZIndex&&(this._lastZIndex++,k.setZIndex(this._lastZIndex))},_update:function(){if(!this._container){return}this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var j=!1,g=!1;for(var k in this._layers){if(this._layers.hasOwnProperty(k)){var h=this._layers[k];this._addItem(h),g=g||h.overlay,j=j||!h.overlay}}this._separator.style.display=g&&j?"":"none"},_createRadioElement:function(j,g){var k='<input type="radio" name="'+j+'"';g&&(k+=' checked="checked"'),k+="/>";var h=document.createElement("div");return h.innerHTML=k,h.firstChild},_addItem:function(l){var h=document.createElement("label"),k,g=this._map.hasLayer(l.layer);l.overlay?(k=document.createElement("input"),k.type="checkbox",k.defaultChecked=g):k=this._createRadioElement("leaflet-base-layers",g),k.layerId=f.Util.stamp(l.layer),f.DomEvent.on(k,"click",this._onInputClick,this);var j=document.createTextNode(" "+l.name);h.appendChild(k),h.appendChild(j);var m=l.overlay?this._overlaysList:this._baseLayersList;m.appendChild(h)},_onInputClick:function(){var k,h,l,j=this._form.getElementsByTagName("input"),g=j.length;for(k=0;k<g;k++){h=j[k],l=this._layers[h.layerId],h.checked?this._map.addLayer(l.layer,!l.overlay):this._map.removeLayer(l.layer)}},_expand:function(){f.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),f.control.layers=function(j,g,h){return new f.Control.Layers(j,g,h)},f.Transition=f.Class.extend({includes:f.Mixin.Events,statics:{CUSTOM_PROPS_SETTERS:{position:f.DomUtil.setPosition},implemented:function(){return f.Transition.NATIVE||f.Transition.TIMER}},options:{easing:"ease",duration:0.5},_setProperty:function(j,g){var h=f.Transition.CUSTOM_PROPS_SETTERS;j in h?h[j](this._el,g):this._el.style[j]=g}}),f.Transition=f.Transition.extend({statics:function(){var h=f.DomUtil.TRANSITION,g=h==="webkitTransition"||h==="OTransition"?h+"End":"transitionend";return{NATIVE:!!h,TRANSITION:h,PROPERTY:h+"Property",DURATION:h+"Duration",EASING:h+"TimingFunction",END:g,CUSTOM_PROPS_PROPERTIES:{position:f.Browser.any3d?f.DomUtil.TRANSFORM:"top, left"}}}(),options:{fakeStepInterval:100},initialize:function(h,g){this._el=h,f.Util.setOptions(this,g),f.DomEvent.on(h,f.Transition.END,this._onTransitionEnd,this),this._onFakeStep=f.Util.bind(this._onFakeStep,this)},run:function(k){var h,j=[],g=f.Transition.CUSTOM_PROPS_PROPERTIES;for(h in k){k.hasOwnProperty(h)&&(h=g[h]?g[h]:h,h=this._dasherize(h),j.push(h))}this._el.style[f.Transition.DURATION]=this.options.duration+"s",this._el.style[f.Transition.EASING]=this.options.easing,this._el.style[f.Transition.PROPERTY]="all";for(h in k){k.hasOwnProperty(h)&&this._setProperty(h,k[h])}f.Util.falseFn(this._el.offsetWidth),this._inProgress=!0,f.Browser.mobileWebkit&&(this.backupEventFire=setTimeout(f.Util.bind(this._onBackupFireEnd,this),this.options.duration*1.2*1000)),f.Transition.NATIVE?(clearInterval(this._timer),this._timer=setInterval(this._onFakeStep,this.options.fakeStepInterval)):this._onTransitionEnd()},_dasherize:function(){function g(j){return"-"+j.toLowerCase()}var h=/([A-Z])/g;return function(e){return e.replace(h,g)}}(),_onFakeStep:function(){this.fire("step")},_onTransitionEnd:function(g){this._inProgress&&(this._inProgress=!1,clearInterval(this._timer),this._el.style[f.Transition.TRANSITION]="",clearTimeout(this.backupEventFire),delete this.backupEventFire,this.fire("step"),g&&g.type&&this.fire("end"))},_onBackupFireEnd:function(){var g=document.createEvent("Event");g.initEvent(f.Transition.END,!0,!1),this._el.dispatchEvent(g)}}),f.Transition=f.Transition.NATIVE?f.Transition:f.Transition.extend({statics:{getTime:Date.now||function(){return +(new Date)},TIMER:!0,EASINGS:{linear:function(g){return g},"ease-out":function(g){return g*(2-g)}},CUSTOM_PROPS_GETTERS:{position:f.DomUtil.getPosition},UNIT_RE:/^[\d\.]+(\D*)$/},options:{fps:50},initialize:function(h,g){this._el=h,f.Util.extend(this.options,g),this._easing=f.Transition.EASINGS[this.options.easing]||f.Transition.EASINGS["ease-out"],this._step=f.Util.bind(this._step,this),this._interval=Math.round(1000/this.options.fps)},run:function(l){this._props={};var h=f.Transition.CUSTOM_PROPS_GETTERS,k=f.Transition.UNIT_RE;this.fire("start");for(var g in l){if(l.hasOwnProperty(g)){var j={};if(g in h){j.from=h[g](this._el)}else{var m=this._el.style[g].match(k);j.from=parseFloat(m[0]),j.unit=m[1]}j.to=l[g],this._props[g]=j}}clearInterval(this._timer),this._timer=setInterval(this._step,this._interval),this._startTime=f.Transition.getTime()},_step:function(){var j=f.Transition.getTime(),g=j-this._startTime,h=this.options.duration*1000;g<h?this._runFrame(this._easing(g/h)):(this._runFrame(1),this._complete())},_runFrame:function(l){var h=f.Transition.CUSTOM_PROPS_SETTERS,k,g,j;for(k in this._props){this._props.hasOwnProperty(k)&&(g=this._props[k],k in h?(j=g.to.subtract(g.from).multiplyBy(l).add(g.from),h[k](this._el,j)):this._el.style[k]=(g.to-g.from)*l+g.from+g.unit)}this.fire("step")},_complete:function(){clearInterval(this._timer),this.fire("end")}}),f.Map.include(!f.Transition||!f.Transition.implemented()?{}:{setView:function(k,h,l){h=this._limitZoom(h);var j=this._zoom!==h;if(this._loaded&&!l&&this._layers){var g=j?this._zoomToIfClose&&this._zoomToIfClose(k,h):this._panByIfClose(k);if(g){return clearTimeout(this._sizeTimer),this}}return this._resetView(k,h),this},panBy:function(h,g){return h=f.point(h),!h.x&&!h.y?this:(this._panTransition||(this._panTransition=new f.Transition(this._mapPane),this._panTransition.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),f.Util.setOptions(this._panTransition,f.Util.extend({duration:0.25},g)),this.fire("movestart"),f.DomUtil.addClass(this._mapPane,"leaflet-pan-anim"),this._panTransition.run({position:f.DomUtil.getPosition(this._mapPane).subtract(h)}),this)},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){f.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_panByIfClose:function(h){var g=this._getCenterOffset(h)._floor();return this._offsetIsWithinView(g)?(this.panBy(g),!0):!1},_offsetIsWithinView:function(j,g){var k=g||1,h=this.getSize();return Math.abs(j.x)<=h.x*k&&Math.abs(j.y)<=h.y*k}}),f.Map.mergeOptions({zoomAnimation:f.DomUtil.TRANSITION&&!f.Browser.android23&&!f.Browser.mobileOpera}),f.DomUtil.TRANSITION&&f.Map.addInitHook(function(){f.DomEvent.on(this._mapPane,f.Transition.END,this._catchTransitionEnd,this)}),f.Map.include(f.DomUtil.TRANSITION?{_zoomToIfClose:function(l,h){if(this._animatingZoom){return !0}if(!this.options.zoomAnimation){return !1}var k=this.getZoomScale(h),g=this._getCenterOffset(l).divideBy(1-1/k);if(!this._offsetIsWithinView(g,1)){return !1}f.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this.fire("movestart").fire("zoomstart"),this.fire("zoomanim",{center:l,zoom:h});var j=this._getCenterLayerPoint().add(g);return this._prepareTileBg(),this._runAnimation(l,h,k,j),!0},_catchTransitionEnd:function(g){this._animatingZoom&&this._onZoomTransitionEnd()},_runAnimation:function(l,p,g,j,q){this._animateToCenter=l,this._animateToZoom=p,this._animatingZoom=!0;var h=f.DomUtil.TRANSFORM,n=this._tileBg;clearTimeout(this._clearTileBgTimer),f.Util.falseFn(n.offsetWidth);var m=f.DomUtil.getScaleString(g,j),k=n.style[h];n.style[h]=q?k+" "+m:m+" "+k},_prepareTileBg:function(){var j=this._tilePane,g=this._tileBg;if(g&&this._getLoadedTilesPercentage(g)>0.5&&this._getLoadedTilesPercentage(j)<0.5){j.style.visibility="hidden",j.empty=!0,this._stopLoadingImages(j);return}g||(g=this._tileBg=this._createPane("leaflet-tile-pane",this._mapPane),g.style.zIndex=1),g.style[f.DomUtil.TRANSFORM]="",g.style.visibility="hidden",g.empty=!0,j.empty=!1,this._tilePane=this._panes.tilePane=g;var h=this._tileBg=j;f.DomUtil.addClass(h,"leaflet-zoom-animated"),this._stopLoadingImages(h)},_getLoadedTilesPercentage:function(k){var h=k.getElementsByTagName("img"),l,j,g=0;for(l=0,j=h.length;l<j;l++){h[l].complete&&g++}return g/j},_stopLoadingImages:function(l){var h=Array.prototype.slice.call(l.getElementsByTagName("img")),k,g,j;for(k=0,g=h.length;k<g;k++){j=h[k],j.complete||(j.onload=f.Util.falseFn,j.onerror=f.Util.falseFn,j.src=f.Util.emptyImageUrl,j.parentNode.removeChild(j))}},_onZoomTransitionEnd:function(){this._restoreTileFront(),f.Util.falseFn(this._tileBg.offsetWidth),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),f.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1},_restoreTileFront:function(){this._tilePane.innerHTML="",this._tilePane.style.visibility="",this._tilePane.style.zIndex=2,this._tileBg.style.zIndex=1},_clearTileBg:function(){!this._animatingZoom&&!this.touchZoom._zooming&&(this._tileBg.innerHTML="")}}:{}),f.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:Infinity,timeout:10000,maximumAge:0,enableHighAccuracy:!1},locate:function(j){j=this._locationOptions=f.Util.extend(this._defaultLocateOptions,j);if(!navigator.geolocation){return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this}var g=f.Util.bind(this._handleGeolocationResponse,this),h=f.Util.bind(this._handleGeolocationError,this);return j.watch?this._locationWatchId=navigator.geolocation.watchPosition(g,h,j):navigator.geolocation.getCurrentPosition(g,h,j),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this},_handleGeolocationError:function(h){var g=h.code,j=h.message||(g===1?"permission denied":g===2?"position unavailable":"timeout");this._locationOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:g,message:"Geolocation error: "+j+"."})},_handleGeolocationResponse:function(n){var w=180*n.coords.accuracy/40000000,g=w*2,k=n.coords.latitude,x=n.coords.longitude,h=new f.LatLng(k,x),v=new f.LatLng(k-w,x-g),q=new f.LatLng(k+w,x+g),m=new f.LatLngBounds(v,q),j=this._locationOptions;if(j.setView){var p=Math.min(this.getBoundsZoom(m),j.maxZoom);this.setView(h,p)}this.fire("locationfound",{latlng:h,bounds:m,accuracy:n.coords.accuracy})}})})(this);!function(a,c,b){if(typeof module!=="undefined"){module.exports=b(a,c)}else{if(typeof define==="function"&&typeof define.amd==="object"){define(b)}else{c[a]=b(a,c)}}}("bean",this,function(o,R){var H=window,J=R[o],G=/over|out/,w=/[^\.]*(?=\..*)\.|.*/,E=/\..*/,n="addEventListener",h="attachEvent",a="removeEventListener",q="detachEvent",k=document||{},x=k.documentElement||{},t=x[n],y=t?n:h,r=Array.prototype.slice,c=/click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i,M=/mouse.*(wheel|scroll)/i,F=/^text/i,I=/^touch|^gesture/i,C={one:1},P=(function(U,T,S){for(S=0;S<T.length;S++){U[T[S]]=1}return U})({},("click dblclick mouseup mousedown contextmenu mousewheel mousemultiwheel DOMMouseScroll mouseover mouseout mousemove selectstart selectend keydown keypress keyup orientationchange focus blur change reset select submit load unload beforeunload resize move DOMContentLoaded readystatechange error abort scroll "+(t?"show input invalid touchstart touchmove touchend touchcancel gesturestart gesturechange gestureend message readystatechange pageshow pagehide popstate hashchange offline online afterprint beforeprint dragstart dragenter dragover dragleave drag drop dragend loadstart progress suspend emptied stalled loadmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate play pause ratechange volumechange cuechange checking noupdate downloading cached updateready obsolete ":"")).split(" ")),B=(function(){function T(U,V){while((V=V.parentNode)!==null){if(V===U){return true}}return false}function S(U){var V=U.relatedTarget;if(!V){return V===null}return(V!==this&&V.prefix!=="xul"&&!/document/.test(this.toString())&&!T(this,V))}return{mouseenter:{base:"mouseover",condition:S},mouseleave:{base:"mouseout",condition:S},mousewheel:{base:/Firefox/.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel"}}})(),Q=(function(){var ab="altKey attrChange attrName bubbles cancelable ctrlKey currentTarget detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey srcElement target timeStamp type view which".split(" "),Y=ab.concat("button buttons clientX clientY dataTransfer fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" ")),S=Y.concat("wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ axis".split(" ")),V=ab.concat("char charCode key keyCode keyIdentifier keyLocation".split(" ")),U=ab.concat(["data"]),aa=ab.concat("touches targetTouches changedTouches scale rotation".split(" ")),X="preventDefault",ad=function(ae){return function(){if(ae[X]){ae[X]()}else{ae.returnValue=false}}},Z="stopPropagation",ac=function(ae){return function(){if(ae[Z]){ae[Z]()}else{ae.cancelBubble=true}}},W=function(ae){return function(){ae[X]();ae[Z]();ae.stopped=true}},T=function(ah,ae,ag){var af,ai;for(af=ag.length;af--;){ai=ag[af];if(!(ai in ae)&&ai in ah){ae[ai]=ah[ai]}}};return function(ai,af){var ae={originalEvent:ai,isNative:af};if(!ai){return ae}var ah,ag=ai.type,aj=ai.target||ai.srcElement;ae[X]=ad(ai);ae[Z]=ac(ai);ae.stop=W(ae);ae.target=aj&&aj.nodeType===3?aj.parentNode:aj;if(af){if(ag.indexOf("key")!==-1){ah=V;ae.keyCode=ai.which||ai.keyCode}else{if(c.test(ag)){ah=Y;ae.rightClick=ai.which===3||ai.button===2;ae.pos={x:0,y:0};if(ai.pageX||ai.pageY){ae.clientX=ai.pageX;ae.clientY=ai.pageY}else{if(ai.clientX||ai.clientY){ae.clientX=ai.clientX+k.body.scrollLeft+x.scrollLeft;ae.clientY=ai.clientY+k.body.scrollTop+x.scrollTop}}if(G.test(ag)){ae.relatedTarget=ai.relatedTarget||ai[(ag==="mouseover"?"from":"to")+"Element"]}}else{if(I.test(ag)){ah=aa}else{if(M.test(ag)){ah=S}else{if(F.test(ag)){ah=U}}}}}T(ai,ae,ah||ab)}return ae}})(),d=function(T,S){return !t&&!S&&(T===k||T===H)?x:T},m=(function(){function S(U,W,V,T,X){this.element=U;this.type=W;this.handler=V;this.original=T;this.namespaces=X;this.custom=B[W];this.isNative=P[W]&&U[y];this.eventType=t||this.isNative?W:"propertychange";this.customType=!t&&!this.isNative&&W;this.target=d(U,this.isNative);this.eventSupport=this.target[y]}S.prototype={inNamespaces:function(V){var U,T;if(!V){return true}if(!this.namespaces){return false}for(U=V.length;U--;){for(T=this.namespaces.length;T--;){if(V[U]===this.namespaces[T]){return true}}}return false},matches:function(U,T,V){return this.element===U&&(!T||this.original===T)&&(!V||this.handler===V)}};return S})(),O=(function(){var X={},W=function(ab,ae,Z,ah,af){if(!ae||ae==="*"){for(var ai in X){if(ai.charAt(0)==="$"){W(ab,ai.substr(1),Z,ah,af)}}}else{var ac=0,aa,ad=X["$"+ae],ag=ab==="*";if(!ad){return}for(aa=ad.length;ac<aa;ac++){if(ag||ad[ac].matches(ab,Z,ah)){if(!af(ad[ac],ad,ac,ae)){return}}}}},V=function(ab,ac,aa){var Z,ad=X["$"+ac];if(ad){for(Z=ad.length;Z--;){if(ad[Z].matches(ab,aa,null)){return true}}}return false},U=function(ab,ac,aa){var Z=[];W(ab,ac,aa,null,function(ad){return Z.push(ad)});return Z},Y=function(Z){(X["$"+Z.type]||(X["$"+Z.type]=[])).push(Z);return Z},T=function(Z){W(Z.element,Z.type,null,Z.handler,function(ab,ac,aa){ac.splice(aa,1);if(ac.length===0){delete X["$"+ab.type]}return false})},S=function(){var aa,Z=[];for(aa in X){if(aa.charAt(0)==="$"){Z=Z.concat(X[aa])}}return Z};return{has:V,get:U,put:Y,del:T,entries:S}})(),K=t?function(S,U,T,V){S[V?n:a](U,T,false)}:function(S,U,T,W,V){if(V&&W&&S["_on"+V]===null){S["_on"+V]=0}S[W?h:q]("on"+U,T)},A=function(T,U,S){return function(V){V=Q(V||((this.ownerDocument||this.document||this).parentWindow||H).event,true);return U.apply(T,[V].concat(S))}},f=function(U,W,V,X,T,S){return function(Y){if(X?X.apply(this,arguments):t?true:Y&&Y.propertyName==="_on"+V||!Y){if(Y){Y=Q(Y||((this.ownerDocument||this.document||this).parentWindow||H).event,S)}W.apply(U,Y&&(!T||T.length===0)?arguments:r.call(arguments,Y?0:1).concat(T))}}},v=function(W,S,U,T,V){return function(){W(S,U,V);T.apply(this,arguments)}},b=function(W,U,aa,S){var X,V,Z,Y=(U&&U.replace(E,"")),T=O.get(W,Y,aa);for(X=0,V=T.length;X<V;X++){if(T[X].inNamespaces(S)){if((Z=T[X]).eventSupport){K(Z.target,Z.eventType,Z.handler,false,Z.type)}O.del(Z)}}},j=function(T,Z,V,Y,S){var W,U=Z.replace(E,""),X=Z.replace(w,"").split(".");if(O.has(T,U,V)){return T}if(U==="unload"){V=v(b,T,U,V,Y)}if(B[U]){if(B[U].condition){V=f(T,V,U,B[U].condition,true)}U=B[U].base||U}W=O.put(new m(T,U,V,Y,X[0]&&X));W.handler=W.isNative?A(T,W.handler,S):f(T,W.handler,U,false,S,false);if(W.eventSupport){K(W.target,W.eventType,W.handler,true,W.customType)}},p=function(S,T,U){return function(X){var W,V,Y=typeof S==="string"?U(S,this):S;for(W=X.target;W&&W!==this;W=W.parentNode){for(V=Y.length;V--;){if(Y[V]===W){return T.apply(W,arguments)}}}}},z=function(W,Z,ab){var V,U,aa,T,X,Y=b,S=Z&&typeof Z==="string";if(S&&Z.indexOf(" ")>0){Z=Z.split(" ");for(X=Z.length;X--;){z(W,Z[X],ab)}return W}aa=S&&Z.replace(E,"");if(aa&&B[aa]){aa=B[aa].type}if(!Z||S){if(T=S&&Z.replace(w,"")){T=T.split(".")}Y(W,aa,ab,T)}else{if(typeof Z==="function"){Y(W,null,Z)}else{for(V in Z){if(Z.hasOwnProperty(V)){z(W,V,Z[V])}}}}return W},g=function(U,ac,aa,S,T){var Y,W,V,X,Z=aa,ab=aa&&typeof aa==="string";if(ac&&!aa&&typeof ac==="object"){for(Y in ac){if(ac.hasOwnProperty(Y)){g.apply(this,[U,Y,ac[Y]])}}}else{X=arguments.length>3?r.call(arguments,3):[];W=(ab?aa:ac).split(" ");ab&&(aa=p(ac,(Z=S),T))&&(X=r.call(X,1));this===C&&(aa=v(z,U,ac,aa,Z));for(V=W.length;V--;){j(U,W[V],aa,Z,X)}}return U},l=function(){return g.apply(C,arguments)},N=t?function(T,V,U){var S=k.createEvent(T?"HTMLEvents":"UIEvents");S[T?"initEvent":"initUIEvent"](V,true,true,H,1);U.dispatchEvent(S)}:function(S,U,T){T=d(T,S);S?T.fireEvent("on"+U,k.createEventObject()):T["_on"+U]++},u=function(V,aa,Y){var W,U,T,Z,S,X=aa.split(" ");for(W=X.length;W--;){aa=X[W].replace(E,"");if(Z=X[W].replace(w,"")){Z=Z.split(".")}if(!Z&&!Y&&V[y]){N(P[aa],aa,V)}else{S=O.get(V,aa);Y=[false].concat(Y);for(U=0,T=S.length;U<T;U++){if(S[U].inNamespaces(Z)){S[U].handler.apply(V,Y)}}}}return V},s=function(V,X,W){var U=0,T=O.get(X,W),S=T.length;for(;U<S;U++){T[U].original&&g(V,T[U].type,T[U].original)}return V},D={add:g,one:l,remove:z,clone:s,fire:u,noConflict:function(){R[o]=J;return this}};if(H[h]){var e=function(){var T,S=O.entries();for(T in S){if(S[T].type&&S[T].type!=="unload"){z(S[T].element,S[T].type)}}H[q]("onunload",e);H.CollectGarbage&&H.CollectGarbage()};H[h]("onunload",e)}return D});var html4={};html4.atype={NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10};html4.ATTRIBS={"*::class":9,"*::dir":0,"*::id":4,"*::lang":0,"*::onclick":2,"*::ondblclick":2,"*::onkeydown":2,"*::onkeypress":2,"*::onkeyup":2,"*::onload":2,"*::onmousedown":2,"*::onmousemove":2,"*::onmouseout":2,"*::onmouseover":2,"*::onmouseup":2,"*::style":3,"*::title":0,"a::accesskey":0,"a::coords":0,"a::href":1,"a::hreflang":0,"a::name":7,"a::onblur":2,"a::onfocus":2,"a::rel":0,"a::rev":0,"a::shape":0,"a::tabindex":0,"a::target":10,"a::type":0,"area::accesskey":0,"area::alt":0,"area::coords":0,"area::href":1,"area::nohref":0,"area::onblur":2,"area::onfocus":2,"area::shape":0,"area::tabindex":0,"area::target":10,"bdo::dir":0,"blockquote::cite":1,"br::clear":0,"button::accesskey":0,"button::disabled":0,"button::name":8,"button::onblur":2,"button::onfocus":2,"button::tabindex":0,"button::type":0,"button::value":0,"canvas::height":0,"canvas::width":0,"caption::align":0,"col::align":0,"col::char":0,"col::charoff":0,"col::span":0,"col::valign":0,"col::width":0,"colgroup::align":0,"colgroup::char":0,"colgroup::charoff":0,"colgroup::span":0,"colgroup::valign":0,"colgroup::width":0,"del::cite":1,"del::datetime":0,"dir::compact":0,"div::align":0,"dl::compact":0,"font::color":0,"font::face":0,"font::size":0,"form::accept":0,"form::action":1,"form::autocomplete":0,"form::enctype":0,"form::method":0,"form::name":7,"form::onreset":2,"form::onsubmit":2,"form::target":10,"h1::align":0,"h2::align":0,"h3::align":0,"h4::align":0,"h5::align":0,"h6::align":0,"hr::align":0,"hr::noshade":0,"hr::size":0,"hr::width":0,"iframe::align":0,"iframe::frameborder":0,"iframe::height":0,"iframe::marginheight":0,"iframe::marginwidth":0,"iframe::width":0,"img::align":0,"img::alt":0,"img::border":0,"img::height":0,"img::hspace":0,"img::ismap":0,"img::name":7,"img::src":1,"img::usemap":11,"img::vspace":0,"img::width":0,"input::accept":0,"input::accesskey":0,"input::align":0,"input::alt":0,"input::autocomplete":0,"input::checked":0,"input::disabled":0,"input::ismap":0,"input::maxlength":0,"input::name":8,"input::onblur":2,"input::onchange":2,"input::onfocus":2,"input::onselect":2,"input::readonly":0,"input::size":0,"input::src":1,"input::tabindex":0,"input::type":0,"input::usemap":11,"input::value":0,"ins::cite":1,"ins::datetime":0,"label::accesskey":0,"label::for":5,"label::onblur":2,"label::onfocus":2,"legend::accesskey":0,"legend::align":0,"li::type":0,"li::value":0,"map::name":7,"menu::compact":0,"ol::compact":0,"ol::start":0,"ol::type":0,"optgroup::disabled":0,"optgroup::label":0,"option::disabled":0,"option::label":0,"option::selected":0,"option::value":0,"p::align":0,"pre::width":0,"q::cite":1,"select::disabled":0,"select::multiple":0,"select::name":8,"select::onblur":2,"select::onchange":2,"select::onfocus":2,"select::size":0,"select::tabindex":0,"table::align":0,"table::bgcolor":0,"table::border":0,"table::cellpadding":0,"table::cellspacing":0,"table::frame":0,"table::rules":0,"table::summary":0,"table::width":0,"tbody::align":0,"tbody::char":0,"tbody::charoff":0,"tbody::valign":0,"td::abbr":0,"td::align":0,"td::axis":0,"td::bgcolor":0,"td::char":0,"td::charoff":0,"td::colspan":0,"td::headers":6,"td::height":0,"td::nowrap":0,"td::rowspan":0,"td::scope":0,"td::valign":0,"td::width":0,"textarea::accesskey":0,"textarea::cols":0,"textarea::disabled":0,"textarea::name":8,"textarea::onblur":2,"textarea::onchange":2,"textarea::onfocus":2,"textarea::onselect":2,"textarea::readonly":0,"textarea::rows":0,"textarea::tabindex":0,"tfoot::align":0,"tfoot::char":0,"tfoot::charoff":0,"tfoot::valign":0,"th::abbr":0,"th::align":0,"th::axis":0,"th::bgcolor":0,"th::char":0,"th::charoff":0,"th::colspan":0,"th::headers":6,"th::height":0,"th::nowrap":0,"th::rowspan":0,"th::scope":0,"th::valign":0,"th::width":0,"thead::align":0,"thead::char":0,"thead::charoff":0,"thead::valign":0,"tr::align":0,"tr::bgcolor":0,"tr::char":0,"tr::charoff":0,"tr::valign":0,"ul::compact":0,"ul::type":0};html4.eflags={OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128};html4.ELEMENTS={a:0,abbr:0,acronym:0,address:0,applet:16,area:2,b:0,base:18,basefont:18,bdo:0,big:0,blockquote:0,body:49,br:2,button:0,canvas:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,dd:1,del:0,dfn:0,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,font:0,form:0,frame:18,frameset:16,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:49,hr:2,html:49,i:0,iframe:4,img:2,input:2,ins:0,isindex:18,kbd:0,label:0,legend:0,li:1,link:18,map:0,menu:0,meta:18,nobr:0,noembed:4,noframes:20,noscript:20,object:16,ol:0,optgroup:0,option:1,p:1,param:18,pre:0,q:0,s:0,samp:0,script:84,select:0,small:0,span:0,strike:0,strong:0,style:148,sub:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,title:24,tr:1,tt:0,u:0,ul:0,"var":0};html4.ueffects={NOT_LOADED:0,SAME_DOCUMENT:1,NEW_DOCUMENT:2};html4.URIEFFECTS={"a::href":2,"area::href":2,"blockquote::cite":0,"body::background":1,"del::cite":0,"form::action":2,"img::src":1,"input::src":1,"ins::cite":0,"q::cite":0};html4.ltypes={UNSANDBOXED:2,SANDBOXED:1,DATA:0};html4.LOADERTYPES={"a::href":2,"area::href":2,"blockquote::cite":2,"body::background":1,"del::cite":2,"form::action":2,"img::src":1,"input::src":1,"ins::cite":2,"q::cite":2};var html=(function(l){var b;if("script"==="SCRIPT".toLowerCase()){b=function(B){return B.toLowerCase()}}else{b=function(B){return B.replace(/[A-Z]/g,function(C){return String.fromCharCode(C.charCodeAt(0)|32)})}}var r={lt:"<",gt:">",amp:"&",nbsp:"\240",quot:'"',apos:"'"};var p=/^(?:https?|mailto|data)$/i;var n=/^#(\d+)$/;var x=/^#x([0-9A-Fa-f]+)$/;function j(C){C=b(C);if(r.hasOwnProperty(C)){return r[C]}var B=C.match(n);if(B){return String.fromCharCode(parseInt(B[1],10))}else{if(!!(B=C.match(x))){return String.fromCharCode(parseInt(B[1],16))}}return""}function c(C,B){return j(B)}var u=/\0/g;function m(B){return B.replace(u,"")}var v=/&(#\d+|#x[0-9A-Fa-f]+|\w+);/g;function e(B){return B.replace(v,c)}var t=/&/g;var A=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi;var a=/</g;var f=/>/g;var o=/\"/g;var h=/\=/g;function g(B){return B.replace(t,"&amp;").replace(a,"&lt;").replace(f,"&gt;").replace(o,"&#34;").replace(h,"&#61;")}function k(B){return B.replace(A,"&amp;$1").replace(a,"&lt;").replace(f,"&gt;")}var y=new RegExp("^\\s*(?:"+("(?:([a-z][a-z-]*)"+("(\\s*=\\s*"+("(\"[^\"]*\"|'[^']*'|(?=[a-z][a-z-]*\\s*=)|[^>\"'\\s]*)")+")")+"?)")+"|(/?>)|[\\s\\S][^a-z\\s>]*)","i");var z=new RegExp("^(?:&(\\#[0-9]+|\\#[x][0-9a-f]+|\\w+);|<!--[\\s\\S]*?-->|<!\\w[^>]*>|<\\?[^>*]*>|<(/)?([a-z][a-z0-9]*)|([^<&>]+)|([<&>]))","i");function q(B){return function C(O,M){O=String(O);var P=null;var G=false;var E=[];var H=void 0;var I=void 0;var F=void 0;if(B.startDoc){B.startDoc(M)}while(O){var K=O.match(G?y:z);O=O.substring(K[0].length);if(G){if(K[1]){var J=b(K[1]);var R;if(K[2]){var N=K[3];switch(N.charCodeAt(0)){case 34:case 39:N=N.substring(1,N.length-1);break}R=e(m(N))}else{R=J}E.push(J,R)}else{if(K[4]){if(I!==void 0){if(F){if(B.startTag){B.startTag(H,E,M)}}else{if(B.endTag){B.endTag(H,M)}}}if(F&&(I&(l.eflags.CDATA|l.eflags.RCDATA))){if(P===null){P=b(O)}else{P=P.substring(P.length-O.length)}var Q=P.indexOf("</"+H);if(Q<0){Q=O.length}if(Q){if(I&l.eflags.CDATA){if(B.cdata){B.cdata(O.substring(0,Q),M)}}else{if(B.rcdata){B.rcdata(k(O.substring(0,Q)),M)}}O=O.substring(Q)}}H=I=F=void 0;E.length=0;G=false}}}else{if(K[1]){if(B.pcdata){B.pcdata(K[0],M)}}else{if(K[3]){F=!K[2];G=true;H=b(K[3]);I=l.ELEMENTS.hasOwnProperty(H)?l.ELEMENTS[H]:void 0}else{if(K[4]){if(B.pcdata){B.pcdata(K[4],M)}}else{if(K[5]){if(B.pcdata){var D=K[5];B.pcdata(D==="<"?"&lt;":D===">"?"&gt;":"&amp;",M)}}}}}}}if(B.endDoc){B.endDoc(M)}}}function w(C){var B;var D;return q({startDoc:function(E){B=[];D=false},startTag:function(H,K,F){if(D){return}if(!l.ELEMENTS.hasOwnProperty(H)){return}var E=l.ELEMENTS[H];if(E&l.eflags.FOLDABLE){return}else{if(E&l.eflags.UNSAFE){D=!(E&l.eflags.EMPTY);return}}K=C(H,K);if(K){if(!(E&l.eflags.EMPTY)){B.push(H)}F.push("<",H);for(var G=0,M=K.length;G<M;G+=2){var I=K[G],J=K[G+1];if(J!==null&&J!==void 0){F.push(" ",I,'="',g(J),'"')}}F.push(">")}},endTag:function(I,G){if(D){D=false;return}if(!l.ELEMENTS.hasOwnProperty(I)){return}var E=l.ELEMENTS[I];if(!(E&(l.eflags.UNSAFE|l.eflags.EMPTY|l.eflags.FOLDABLE))){var F;if(E&l.eflags.OPTIONAL_ENDTAG){for(F=B.length;--F>=0;){var J=B[F];if(J===I){break}if(!(l.ELEMENTS[J]&l.eflags.OPTIONAL_ENDTAG)){return}}}else{for(F=B.length;--F>=0;){if(B[F]===I){break}}}if(F<0){return}for(var H=B.length;--H>F;){var J=B[H];if(!(l.ELEMENTS[J]&l.eflags.OPTIONAL_ENDTAG)){G.push("</",J,">")}}B.length=F;G.push("</",I,">")}},pcdata:function(F,E){if(!D){E.push(F)}},rcdata:function(F,E){if(!D){E.push(F)}},cdata:function(F,E){if(!D){E.push(F)}},endDoc:function(E){for(var F=B.length;--F>=0;){E.push("</",B[F],">")}B.length=0}})}var s=new RegExp("^(?:([^:/?#]+):)?");function d(F,D,E){var B=[];w(function C(J,O){for(var I=0;I<O.length;I+=2){var K=O[I];var M=O[I+1];var H=null,G;if((G=J+"::"+K,l.ATTRIBS.hasOwnProperty(G))||(G="*::"+K,l.ATTRIBS.hasOwnProperty(G))){H=l.ATTRIBS[G]}if(H!==null){switch(H){case l.atype.NONE:break;case l.atype.SCRIPT:case l.atype.STYLE:M=null;break;case l.atype.ID:case l.atype.IDREF:case l.atype.IDREFS:case l.atype.GLOBAL_NAME:case l.atype.LOCAL_NAME:case l.atype.CLASSES:M=E?E(M):M;break;case l.atype.URI:var N=(""+M).match(s);if(!N){M=null}else{if(!N[1]||p.test(N[1])){M=D&&D(M)}else{M=null}}break;case l.atype.URI_FRAGMENT:if(M&&"#"===M.charAt(0)){M=E?E(M):M;if(M){M="#"+M}}else{M=null}break;default:M=null;break}}else{M=null}O[I+1]=M}return O})(F,B);return B.join("")}return{escapeAttrib:g,makeHtmlSanitizer:w,makeSaxParser:q,normalizeRCData:k,sanitize:d,unescapeEntities:e}})(html4);var html_sanitize=html.sanitize;if(typeof window!=="undefined"){window.html=html;window.html_sanitize=html_sanitize}html4.ATTRIBS["*::style"]=0;html4.ELEMENTS.style=0;html4.ATTRIBS["a::target"]=0;html4.ELEMENTS.video=0;html4.ATTRIBS["video::src"]=0;html4.ATTRIBS["video::poster"]=0;html4.ATTRIBS["video::controls"]=0;html4.ELEMENTS.audio=0;html4.ATTRIBS["audio::src"]=0;html4.ATTRIBS["video::autoplay"]=0;html4.ATTRIBS["video::controls"]=0;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
var Mustache=(typeof module!=="undefined"&&module.exports)||{};(function(x){x.name="mustache.js";x.version="0.5.0-dev";x.tags=["{{","}}"];x.parse=n;x.compile=e;x.render=w;x.clearCache=v;x.to_html=function(B,z,A,C){var y=w(B,z,A);if(typeof C==="function"){C(y)}else{return y}};var t=Object.prototype.toString;var f=Array.isArray;var b=Array.prototype.forEach;var g=String.prototype.trim;var j;if(f){j=f}else{j=function(y){return t.call(y)==="[object Array]"}}var s;if(b){s=function(z,A,y){return b.call(z,A,y)}}else{s=function(B,C,A){for(var z=0,y=B.length;z<y;++z){C.call(A,B[z],z,B)}}}var l=/^\s*$/;function c(y){return l.test(y)}var q;if(g){q=function(y){return y==null?"":g.call(y)}}else{var o,h;if(c("\xA0")){o=/^\s+/;h=/\s+$/}else{o=/^[\s\xA0]+/;h=/[\s\xA0]+$/}q=function(y){return y==null?"":String(y).replace(o,"").replace(h,"")}}var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function p(y){return String(y).replace(/[&<>"'\/]/g,function(z){return d[z]||z})}function m(E,G,H,A){A=A||"<template>";var I=G.split("\n"),y=Math.max(H-3,0),B=Math.min(I.length,H+3),z=I.slice(y,B);var F;for(var C=0,D=z.length;C<D;++C){F=C+y+1;z[C]=(F===H?" >> ":"    ")+z[C]}E.template=G;E.line=H;E.file=A;E.message=[A+":"+H,z.join("\n"),"",E.message].join("\n");return E}function u(y,G,F){if(y==="."){return G[G.length-1]}var E=y.split(".");var C=E.length-1;var D=E[C];var H,z,B=G.length,A,I;while(B){I=G.slice(0);z=G[--B];A=0;while(A<C){z=z[E[A++]];if(z==null){break}I.push(z)}if(z&&typeof z==="object"&&D in z){H=z[D];break}}if(typeof H==="function"){H=H.call(I[I.length-1])}if(H==null){return F}return H}function k(B,y,F,A){var z="";var D=u(B,y);if(A){if(D==null||D===false||(j(D)&&D.length===0)){z+=F()}}else{if(j(D)){s(D,function(G){y.push(G);z+=F();y.pop()})}else{if(typeof D==="object"){y.push(D);z+=F();y.pop()}else{if(typeof D==="function"){var C=y[y.length-1];var E=function(G){return w(G,C)};z+=D.call(C,F(),E)||""}else{if(D){z+=F()}}}}}return z}function n(ab,C){C=C||{};var M=C.tags||x.tags,N=M[0],H=M[M.length-1];var z=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'];var G=[],ac=false,Z=false;var X=function(){if(ac&&!Z&&!C.space){while(G.length){z.splice(G.pop(),1)}}else{G=[]}ac=false;Z=false};var U=[],R,D,O;var W=function(ad){M=q(ad).split(/\s+/);D=M[0];O=M[M.length-1]};var K=function(ad){z.push('";',R,'\nvar partial = partials["'+q(ad)+'"];',"\nif (partial) {","\n  buffer += render(partial,stack[stack.length - 1],partials);","\n}",'\nbuffer += "')};var y=function(af,ad){var ae=q(af);if(ae===""){throw m(new Error("Section name may not be empty"),ab,J,C.file)}U.push({name:ae,inverted:ad});z.push('";',R,'\nvar name = "'+ae+'";',"\nvar callback = (function () {","\n  return function () {",'\n    var buffer = "";','\nbuffer += "')};var F=function(ad){y(ad,true)};var V=function(ae){var ad=q(ae);var ag=U.length!=0&&U[U.length-1].name;if(!ag||ad!=ag){throw m(new Error('Section named "'+ad+'" was never opened'),ab,J,C.file)}var af=U.pop();z.push('";',"\n    return buffer;","\n  };","\n})();");if(af.inverted){z.push("\nbuffer += renderSection(name,stack,callback,true);")}else{z.push("\nbuffer += renderSection(name,stack,callback);")}z.push('\nbuffer += "')};var Y=function(ad){z.push('";',R,'\nbuffer += lookup("'+q(ad)+'",stack,"");','\nbuffer += "')};var A=function(ad){z.push('";',R,'\nbuffer += escapeHTML(lookup("'+q(ad)+'",stack,""));','\nbuffer += "')};var J=1,aa,E;for(var S=0,T=ab.length;S<T;++S){if(ab.slice(S,S+N.length)===N){S+=N.length;aa=ab.substr(S,1);R="\nline = "+J+";";D=N;O=H;ac=true;switch(aa){case"!":S++;E=null;break;case"=":S++;H="="+H;E=W;break;case">":S++;E=K;break;case"#":S++;E=y;break;case"^":S++;E=F;break;case"/":S++;E=V;break;case"{":H="}"+H;case"&":S++;Z=true;E=Y;break;default:Z=true;E=A}var B=ab.indexOf(H,S);if(B===-1){throw m(new Error('Tag "'+N+'" was not closed properly'),ab,J,C.file)}var Q=ab.substring(S,B);if(E){E(Q)}var P=0;while(~(P=Q.indexOf("\n",P))){J++;P++}S=B+H.length-1;N=D;H=O}else{aa=ab.substr(S,1);switch(aa){case'"':case"\\":Z=true;z.push("\\"+aa);break;case"\r":break;case"\n":G.push(z.length);z.push("\\n");X();J++;break;default:if(c(aa)){G.push(z.length)}else{Z=true}z.push(aa)}}}if(U.length!=0){throw m(new Error('Section "'+U[U.length-1].name+'" was not closed properly'),ab,J,C.file)}X();z.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var I=z.join("").replace(/buffer \+= "";\n/g,"");if(C.debug){if(typeof console!="undefined"&&console.log){console.log(I)}else{if(typeof print==="function"){print(I)}}}return I}function r(C,A){var z="view,partials,stack,lookup,escapeHTML,renderSection,render";var y=n(C,A);var B=new Function(z,y);return function(E,F){F=F||{};var D=[E];try{return B(E,F,D,u,p,k,w)}catch(G){throw m(G.error,C,G.line,A.file)}}}var a={};function v(){a={}}function e(z,y){y=y||{};if(y.cache!==false){if(!a[z]){a[z]=r(z,y)}return a[z]}return r(z,y)}function w(A,y,z){return e(A)(y,z)}})(Mustache);
/*!
  * Reqwest! A general purpose XHR connection manager
  * (c) Dustin Diaz 2011
  * https://github.com/ded/reqwest
  * license MIT
  */
!function(d,c){typeof module!="undefined"?module.exports=c():typeof define=="function"&&define.amd?define(d,c):this[d]=c()}("reqwest",function(){function handleReadyState(a,b,c){return function(){a&&a[readyState]==4&&(twoHundo.test(a.status)?b(a):c(a))}}function setHeaders(a,b){var c=b.headers||{},d;c.Accept=c.Accept||defaultHeaders.accept[b.type]||defaultHeaders.accept["*"],!b.crossOrigin&&!c[requestedWith]&&(c[requestedWith]=defaultHeaders.requestedWith),c[contentType]||(c[contentType]=b.contentType||defaultHeaders.contentType);for(d in c){c.hasOwnProperty(d)&&a.setRequestHeader(d,c[d])}}function generalCallback(a){lastValue=a}function urlappend(a,b){return a+(/\?/.test(a)?"&":"?")+b}function handleJsonp(a,b,c,d){var e=uniqid++,f=a.jsonpCallback||"callback",g=a.jsonpCallbackName||"reqwest_"+e,h=new RegExp("((^|\\?|&)"+f+")=([^&]+)"),i=d.match(h),j=doc.createElement("script"),k=0;i?i[3]==="?"?d=d.replace(h,"$1="+g):g=i[3]:d=urlappend(d,f+"="+g),win[g]=generalCallback,j.type="text/javascript",j.src=d,j.async=!0,typeof j.onreadystatechange!="undefined"&&(j.event="onclick",j.htmlFor=j.id="_reqwest_"+e),j.onload=j.onreadystatechange=function(){if(j[readyState]&&j[readyState]!=="complete"&&j[readyState]!=="loaded"||k){return !1}j.onload=j.onreadystatechange=null,j.onclick&&j.onclick(),a.success&&a.success(lastValue),lastValue=undefined,head.removeChild(j),k=1},head.appendChild(j)}function getRequest(a,b,c){var d=(a.method||"GET").toUpperCase(),e=typeof a=="string"?a:a.url,f=a.processData!==!1&&a.data&&typeof a.data!="string"?reqwest.toQueryString(a.data):a.data||null,g;return(a.type=="jsonp"||d=="GET")&&f&&(e=urlappend(e,f),f=null),a.type=="jsonp"?handleJsonp(a,b,c,e):(g=xhr(),g.open(d,e,!0),setHeaders(g,a),g.onreadystatechange=handleReadyState(g,b,c),a.before&&a.before(g),g.send(f),g)}function Reqwest(a,b){this.o=a,this.fn=b,init.apply(this,arguments)}function setType(a){var b=a.match(/\.(json|jsonp|html|xml)(\?|$)/);return b?b[1]:"js"}function init(o,fn){function complete(a){o.timeout&&clearTimeout(self.timeout),self.timeout=null,o.complete&&o.complete(a)}function success(resp){var r=resp.responseText;if(r){switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r}}fn(resp),o.success&&o.success(resp),complete(resp)}function error(a,b,c){o.error&&o.error(a,b,c),complete(a)}this.url=typeof o=="string"?o:o.url,this.timeout=null;var type=o.type||setType(this.url),self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){self.abort()},o.timeout)),this.request=getRequest(o,success,error)}function reqwest(a,b){return new Reqwest(a,b)}function normalize(a){return a?a.replace(/\r?\n/g,"\r\n"):""}function serial(a,b){var c=a.name,d=a.tagName.toLowerCase(),e=function(a){a&&!a.disabled&&b(c,normalize(a.attributes.value&&a.attributes.value.specified?a.value:a.text))};if(a.disabled||!c){return}switch(d){case"input":if(!/reset|button|image|file/i.test(a.type)){var f=/checkbox/i.test(a.type),g=/radio/i.test(a.type),h=a.value;(!f&&!g||a.checked)&&b(c,normalize(f&&h===""?"on":h))}break;case"textarea":b(c,normalize(a.value));break;case"select":if(a.type.toLowerCase()==="select-one"){e(a.selectedIndex>=0?a.options[a.selectedIndex]:null)}else{for(var i=0;a.length&&i<a.length;i++){a.options[i].selected&&e(a.options[i])}}}}function eachFormElement(){var a=this,b,c,d,e=function(b,c){for(var e=0;e<c.length;e++){var f=b[byTag](c[e]);for(d=0;d<f.length;d++){serial(f[d],a)}}};for(c=0;c<arguments.length;c++){b=arguments[c],/input|select|textarea/i.test(b.tagName)&&serial(b,a),e(b,["input","select","textarea"])}}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var a={};return eachFormElement.apply(function(b,c){b in a?(a[b]&&!isArray(a[b])&&(a[b]=[a[b]]),a[b].push(c)):a[b]=c},arguments),a}var win=window,doc=document,twoHundo=/^20\d$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,lastValue,xmlHttpRequest="XMLHttpRequest",isArray=typeof Array.isArray=="function"?Array.isArray:function(a){return a instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"},requestedWith:xmlHttpRequest},xhr=win[xmlHttpRequest]?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")};return Reqwest.prototype={abort:function(){this.request.abort()},retry:function(){init.call(this,this.o,this.fn)}},reqwest.serializeArray=function(){var a=[];return eachFormElement.apply(function(b,c){a.push({name:b,value:c})},arguments),a},reqwest.serialize=function(){if(arguments.length===0){return""}var a,b,c=Array.prototype.slice.call(arguments,0);return a=c.pop(),a&&a.nodeType&&c.push(a)&&(a=null),a&&(a=a.type),a=="map"?b=serializeHash:a=="array"?b=reqwest.serializeArray:b=serializeQueryString,b.apply(null,c)},reqwest.toQueryString=function(a){var b="",c,d=encodeURIComponent,e=function(a,c){b+=d(a)+"="+d(c)+"&"};if(isArray(a)){for(c=0;a&&c<a.length;c++){e(a[c].name,a[c].value)}}else{for(var f in a){if(!Object.hasOwnProperty.call(a,f)){continue}var g=a[f];if(isArray(g)){for(c=0;c<g.length;c++){e(f,g[c])}}else{e(f,a[f])}}}return b.replace(/&$/,"").replace(/%20/g,"+")},reqwest.compat=function(a,b){return a&&(a.type&&(a.method=a.type)&&delete a.type,a.dataType&&(a.type=a.dataType),a.jsonpCallback&&(a.jsonpCallbackName=a.jsonpCallback)&&delete a.jsonpCallback,a.jsonp&&(a.jsonpCallback=a.jsonp)),new Reqwest(a,b)},reqwest});wax=wax||{};wax.attribution=function(){var c,b={};function d(a){if(/^(https?:\/\/|data:image)/.test(a)){return a}}function e(a){return a}b.content=function(a){if(typeof a==="undefined"){return c.innerHTML}c.innerHTML=html_sanitize(a,d,e);return this};b.element=function(){return c};b.init=function(){c=document.createElement("div");c.className="wax-attribution";return this};return b.init()};wax=wax||{};wax.bwdetect=function(b,h){var e={},a=b.threshold||400,d="http://a.tiles.mapbox.com/mapbox/1.0.0/blue-marble-topo-bathy-jul/0/0/0.png?preventcache="+(+new Date()),g=1,f=b.auto===undefined?true:b.auto;function c(){wax.bw=-1;var j=new Image();j.src=d;var l=true;var k=setTimeout(function(){if(l&&wax.bw==-1){e.bw(0);l=false}},a);j.onload=function(){if(l&&wax.bw==-1){clearTimeout(k);e.bw(1);l=false}}}e.bw=function(j){if(!arguments.length){return g}var k=g;if(wax.bwlisteners&&wax.bwlisteners.length){(function(){listeners=wax.bwlisteners;wax.bwlisteners=[];for(i=0;i<listeners;i++){listeners[i](j)}})()}wax.bw=j;if(g!=(g=j)){h(j)}};e.add=function(){if(f){c()}return this};if(wax.bw==-1){wax.bwlisteners=wax.bwlisteners||[];wax.bwlisteners.push(e.bw)}else{if(wax.bw!==undefined){e.bw(wax.bw)}else{e.add()}}return e};wax.formatter=function(x){var formatter={},f;if(x&&typeof x==="string"){try{eval("f = "+x)}catch(e){if(console){console.log(e)}}}else{if(x&&typeof x==="function"){f=x}else{f=function(){}}}function urlX(url){if(/^(https?:\/\/|data:image)/.test(url)){return url}}function idX(id){return id}formatter.format=function(options,data){try{return html_sanitize(f(options,data),urlX,idX)}catch(e){if(console){console.log(e)}}};return formatter};wax.gi=function(b,d){d=d||{};var a={},c=d.resolution||4,f=d.tileSize||256;function e(g){if(g>=93){g--}if(g>=35){g--}g-=32;return g}a.grid_tile=function(){return b};a.getKey=function(g,h){if(!(b&&b.grid)){return}if((h<0)||(g<0)){return}if((Math.floor(h)>=f)||(Math.floor(g)>=f)){return}return e(b.grid[Math.floor((h)/c)].charCodeAt(Math.floor((g)/c)))};a.gridFeature=function(g,k){var h=this.getKey(g,k),j=b.keys;if(j&&j[h]&&b.data[j[h]]){return b.data[j[h]]}};a.tileFeature=function(h,k,g){if(!b){return}var j=wax.u.offset(g);feature=this.gridFeature(h-j.left,k-j.top);return feature};return a};wax.gm=function(){var c=4,f={},e={},g,d;var b=function(h){return h.replace(/(\.png|\.jpg|\.jpeg)(\d*)/,".grid.json")};function a(j){if(typeof j==="string"){j=[j]}return function h(l){if(!l){return}var m=new RegExp("/(\\d+)\\/(\\d+)\\/(\\d+)\\.[\\w\\._]+");var k=m.exec(l);if(!k){return}return j[parseInt(k[2],10)%j.length].replace(/\{z\}/g,k[1]).replace(/\{x\}/g,k[2]).replace(/\{y\}/g,k[3])}}e.formatter=function(h){if(!arguments.length){return d}d=wax.formatter(h);return e};e.template=function(h){if(!arguments.length){return d}d=wax.template(h);return e};e.gridUrl=function(h){if(!arguments.length){return b}b=typeof h==="function"?h:a(h);return e};e.getGrid=function(j,k){var h=b(j);if(!d||!h){return k(null,null)}wax.request.get(h,function(m,l){if(m){return k(m,null)}k(null,wax.gi(l,{formatter:d,resolution:c}))});return e};e.tilejson=function(h){if(!arguments.length){return g}if(h.template){e.template(h.template)}else{if(h.formatter){e.formatter(h.formatter)}else{d=undefined}}if(h.grids){e.gridUrl(h.grids)}if(h.resolution){c=h.resolution}g=h;return e};return e};wax=wax||{};wax.hash=function(k){k=k||{};function f(){return location.hash.substring(1)}function e(n){var m=window.location;m.replace(m.toString().replace((m.hash||/$/),"#"+n))}var h,d={},g=90-1e-8;function a(n){var l=n.split("/");for(var m=0;m<l.length;m++){l[m]=Number(l[m]);if(isNaN(l[m])){return true}}if(l.length<3){return true}else{if(l.length==3){k.setCenterZoom(l)}}}function b(){var l=k.getCenterZoom();if(h!==l){h=l;e(h)}}function c(l){if(l===h){return}if(a(h=l)){b()}}var j=wax.u.throttle(b,500);d.add=function(){c(f());k.bindChange(j);return this};d.remove=function(){k.unbindChange(j);return this};return d.add()};wax=wax||{};wax.interaction=function(){var p=wax.gm(),g={},b=false,c=false,e,n=4,a,q,u,k,t,s;var o={mousemove:h,touchstart:d,mousedown:d};var m={touchend:r,touchmove:r,touchcancel:f};function l(x){var w=a();for(var v=0;v<w.length;v++){if((w[v][0]<x.y)&&((w[v][0]+256)>x.y)&&(w[v][1]<x.x)&&((w[v][1]+256)>x.x)){return w[v][2]}}return false}function j(){if(c){window.clearTimeout(c);c=null;return true}else{return false}}function h(v){if(b){return}var w=wax.u.eventoffset(v);g.screen_feature(w,function(x){if(x){bean.fire(g,"on",{parent:k(),data:x,formatter:p.formatter().format,e:v})}else{bean.fire(g,"off")}})}function d(v){if(j()){return}b=true;e=wax.u.eventoffset(v);if(v.type==="mousedown"){bean.add(document.body,"click",r)}else{if(v.type==="touchstart"&&v.touches.length===1){bean.fire(g,"off");bean.add(k(),m)}}}function f(){bean.remove(k(),m);b=false}function r(x){var v={},y=wax.u.eventoffset(x);b=false;for(var w in x){v[w]=x[w]}bean.remove(document.body,"mouseup",r);bean.remove(k(),m);if(x.type==="touchend"){g.click(x,e)}else{if(Math.round(y.y/n)===Math.round(e.y/n)&&Math.round(y.x/n)===Math.round(e.x/n)){c=window.setTimeout(function(){c=null;g.click(v,y)},300)}}return r}g.click=function(v,w){g.screen_feature(w,function(x){if(x){bean.fire(g,"on",{parent:k(),data:x,formatter:p.formatter().format,e:v})}})};g.screen_feature=function(x,w){var v=l(x);if(!v){w(null)}p.getGrid(v.src,function(A,z){if(A||!z){return w(null)}var y=z.tileFeature(x.x,x.y,v);w(y)})};g.attach=function(v){if(!arguments.length){return q}q=v;return g};g.detach=function(v){if(!arguments.length){return u}u=v;return g};g.map=function(v){if(!arguments.length){return t}t=v;if(q){q(t)}bean.add(k(),o);bean.add(k(),"touchstart",d);return g};g.grid=function(v){if(!arguments.length){return a}a=v;return g};g.remove=function(v){if(u){u(t)}bean.remove(k(),o);bean.fire(g,"remove");return g};g.tilejson=function(v){if(!arguments.length){return p.tilejson()}p.tilejson(v);return g};g.formatter=function(){return p.formatter()};g.on=function(w,v){bean.add(g,w,v);return g};g.off=function(w,v){bean.remove(g,w,v);return g};g.gridmanager=function(v){if(!arguments.length){return p}p=v;return g};g.parent=function(v){k=v;return g};return g};var wax=wax||{};wax.legend=function(){var c,d={},a;function b(f){if(/^(https?:\/\/|data:image)/.test(f)){return f}}function e(f){return f}d.element=function(){return a};d.content=function(f){if(!arguments.length){return c.innerHTML}if(f){c.innerHTML=html_sanitize(f,b,e);c.style.display="block"}else{c.innerHTML="";c.style.display="none"}return d};d.add=function(){a=document.createElement("div");a.className="wax-legends";c=a.appendChild(document.createElement("div"));c.className="wax-legend";c.style.display="none";return d};return d.add()};var wax=wax||{};wax.location=function(){var b={};function a(d){console.log(d);if((d.e.type==="mousemove"||!d.e.type)){return}else{var c=d.formatter({format:"location"},d.data);if(c){window.location.href=c}}}b.events=function(){return{on:a}};return b};var wax=wax||{};wax.movetip={};wax.movetip=function(){var d=false,k={},a,b,l,j;function g(n){var m=wax.u.eventoffset(n);if((a.height+m.y)>(b.top+b.height)&&(b.height>a.height)){m.y-=a.height;l.className+=" flip-y"}if((a.width+m.x)>(b.left+b.width)){m.x-=a.width;l.className+=" flip-x"}l.style.left=m.x+"px";l.style.top=m.y+"px"}function h(m){var n=document.createElement("div");n.className="wax-tooltip wax-tooltip-0";n.innerHTML=m;return n}function e(){if(l){l.parentNode.removeChild(l);l=null}}function f(r){var p;if(d){return}if((r.e.type==="mousemove"||!r.e.type)){p=r.formatter({format:"teaser"},r.data);if(!p){return}e();j.style.cursor="pointer";l=document.body.appendChild(h(p))}else{p=r.formatter({format:"teaser"},r.data);if(!p){return}e();var m=document.body.appendChild(h(p));m.className+=" wax-popup";var q=m.appendChild(document.createElement("a"));q.href="#close";q.className="close";q.innerHTML="Close";d=true;l=m;a=wax.u.offset(l);b=wax.u.offset(j);g(r.e);bean.add(q,"click touchend",function n(o){o.stop();e();d=false})}if(l){a=wax.u.offset(l);b=wax.u.offset(j);g(r.e)}}function c(){j.style.cursor="default";if(!d){e()}}k.parent=function(m){if(!arguments.length){return j}j=m;return k};k.events=function(){return{on:f,off:c}};return k};var wax=wax||{};wax.request={cache:{},locks:{},promises:{},get:function(a,c){if(this.cache[a]){return c(this.cache[a][0],this.cache[a][1])}else{this.promises[a]=this.promises[a]||[];this.promises[a].push(c);if(this.locks[a]){return}var b=this;this.locks[a]=true;reqwest({url:a+(~a.indexOf("?")?"&":"?")+"callback=grid",type:"jsonp",jsonpCallback:"callback",success:function(e){b.locks[a]=false;b.cache[a]=[null,e];for(var d=0;d<b.promises[a].length;d++){b.promises[a][d](b.cache[a][0],b.cache[a][1])}},error:function(e){b.locks[a]=false;b.cache[a]=[e,null];for(var d=0;d<b.promises[a].length;d++){b.promises[a][d](b.cache[a][0],b.cache[a][1])}}})}}};wax.template=function(a){var c={};function b(e){if(/^(https?:\/\/|data:image)/.test(e)){return e}}function d(e){return e}c.format=function(e,g){var h={};for(var f in g){h[f]=g[f]}if(e.format){h["__"+e.format+"__"]=true}return html_sanitize(Mustache.to_html(a,h),b,d)};return c};if(!wax){var wax={}}wax.tilejson=function(a,b){reqwest({url:a+(~a.indexOf("?")?"&":"?")+"callback=grid",type:"jsonp",jsonpCallback:"callback",success:b,error:b})};var wax=wax||{};wax.tooltip={};wax.tooltip=function(){var d=false,a=false,m={},h=[],k,c,l;if(document.body.style["-webkit-transition"]!==undefined){c="webkitTransitionEnd"}else{if(document.body.style.MozTransition!==undefined){c="transitionend"}}function j(n){var o=document.createElement("div");o.className="wax-tooltip wax-tooltip-0";o.innerHTML=n;return o}function e(){if(this.parentNode){this.parentNode.removeChild(this)}}function f(){var n;while(n=h.pop()){if(a&&c){bean.add(n,c,e);n.className+=" wax-fade"}else{if(n.parentNode){n.parentNode.removeChild(n)}}}}function g(s){var q;if(s.e.type==="mousemove"||!s.e.type){if(!d){q=s.content||s.formatter({format:"teaser"},s.data);if(!q||q==k){return}f();l.style.cursor="pointer";h.push(l.appendChild(j(q)));k=q}}else{q=s.content||s.formatter({format:"full"},s.data);if(!q){if(s.e.type&&s.e.type.match(/touch/)){q=s.content||s.formatter({format:"teaser"},s.data)}if(!q){return}}f();l.style.cursor="pointer";var n=l.appendChild(j(q));n.className+=" wax-popup";var r=n.appendChild(document.createElement("a"));r.href="#close";r.className="close";r.innerHTML="Close";d=true;h.push(n);bean.add(r,"touchstart mousedown",function(o){o.stop()});bean.add(r,"click touchend",function p(o){o.stop();f();d=false})}}function b(){l.style.cursor="default";k=null;if(!d){f()}}m.parent=function(n){if(!arguments.length){return l}l=n;return m};m.animate=function(n){if(!arguments.length){return a}a=n;return m};m.events=function(){return{on:g,off:b}};return m};var wax=wax||{};wax.u={offset:function(b){var a=b.offsetWidth||parseInt(b.style.width,10),j=b.offsetHeight||parseInt(b.style.height,10),h=document.body,g=0,c=0;var k=function(l){if(l===h||l===document.documentElement){return}g+=l.offsetTop;c+=l.offsetLeft;var e=l.style.transform||l.style.WebkitTransform||l.style.OTransform||l.style.MozTransform||l.style.msTransform;if(e){if(match=e.match(/translate\((.+)px, (.+)px\)/)){g+=parseInt(match[2],10);c+=parseInt(match[1],10)}else{if(match=e.match(/translate3d\((.+)px, (.+)px, (.+)px\)/)){g+=parseInt(match[2],10);c+=parseInt(match[1],10)}else{if(match=e.match(/matrix3d\(([\-\d,\s]+)\)/)){var m=match[1].split(",");g+=parseInt(m[13],10);c+=parseInt(m[12],10)}else{if(match=e.match(/matrix\(.+, .+, .+, .+, (.+), (.+)\)/)){g+=parseInt(match[2],10);c+=parseInt(match[1],10)}}}}}};k(b);try{while(b=b.offsetParent){k(b)}}catch(f){}g+=h.offsetTop;c+=h.offsetLeft;g+=h.parentNode.offsetTop;c+=h.parentNode.offsetLeft;var d=document.defaultView?window.getComputedStyle(h.parentNode,null):h.parentNode.currentStyle;if(h.parentNode.offsetTop!==parseInt(d.marginTop,10)&&!isNaN(parseInt(d.marginTop,10))){g+=parseInt(d.marginTop,10);c+=parseInt(d.marginLeft,10)}return{top:g,left:c,height:j,width:a}},"$":function(a){return(typeof a==="string")?document.getElementById(a):a},indexOf:function(e,d){var a=Array.prototype.indexOf;if(e===null){return -1}var c,b;if(a&&e.indexOf===a){return e.indexOf(d)}for(c=0,b=e.length;c<b;c++){if(e[c]===d){return c}}return -1},eventoffset:function(h){var b=0;var j=0;if(!h){h=window.event}if(h.pageX||h.pageY){return{x:h.pageX,y:h.pageY}}else{if(h.clientX||h.clientY){var g=document.documentElement,a=document.body;var d=document.body.parentNode.currentStyle;var c=parseInt(d.marginTop,10)||0;var f=parseInt(d.marginLeft,10)||0;return{x:h.clientX+(g&&g.scrollLeft||a&&a.scrollLeft||0)-(g&&g.clientLeft||a&&a.clientLeft||0)+f,y:h.clientY+(g&&g.scrollTop||a&&a.scrollTop||0)-(g&&g.clientTop||a&&a.clientTop||0)+c}}else{if(h.touches&&h.touches.length===1){return{x:h.touches[0].pageX,y:h.touches[0].pageY}}}}},limit:function(b,d,a){var c;return function(){var f=this,e=arguments;var g=function(){c=null;b.apply(f,e)};if(a){clearTimeout(c)}if(a||!c){c=setTimeout(g,d)}}},throttle:function(a,b){return this.limit(a,b,false)}};wax=wax||{};wax.leaf=wax.leaf||{};wax.leaf.hash=function(a){return wax.hash({getCenterZoom:function(){var b=a.getCenter(),d=a.getZoom(),c=Math.max(0,Math.ceil(Math.log(d)/Math.LN2));return[d,b.lat.toFixed(c),b.lng.toFixed(c)].join("/")},setCenterZoom:function(b){a.setView(new L.LatLng(b[1],b[2]),b[0])},bindChange:function(b){a.on("moveend",b)},unbindChange:function(b){a.off("moveend",b)}})};wax=wax||{};wax.leaf=wax.leaf||{};wax.leaf.interaction=function(){var e=false,c,g;function a(){e=true}function d(){if(!e&&c){return c}else{return(c=(function(k){var m=[];for(var h in k){if(k[h]._tiles){for(var j in k[h]._tiles){var l=wax.u.offset(k[h]._tiles[j]);m.push([l.top,l.left,k[h]._tiles[j]])}}}return m})(g._layers))}}function b(h){if(!arguments.length){return g}g=h;var j=["moveend"];for(var k=0;k<j.length;k++){g.on(j[k],a)}}function f(h){if(!arguments.length){return g}g=h;var j=["moveend"];for(var k=0;k<j.length;k++){g.off(j[k],a)}}return wax.interaction().attach(b).detach(f).parent(function(){return g._container}).grid(d)};wax=wax||{};wax.leaf=wax.leaf||{};wax.leaf.legend=function(c,d){d=d||{};var a,b={};b.add=function(){a=wax.legend().content(d.legend||"");return this};b.content=function(e){if(e){a.content(e.legend||"")}};b.element=function(){return a.element()};b.appendTo=function(e){wax.u.$(e).appendChild(a.element());return this};return b.add()};wax=wax||{};wax.leaf=wax.leaf||{};wax.leaf.connector=L.TileLayer.extend({initialize:function(a){a=a||{};a.minZoom=a.minzoom||0;a.maxZoom=a.maxzoom||22;L.TileLayer.prototype.initialize.call(this,a.tiles[0],a)}});(function(a){a.Map=function(e){var f={},q=$.extend({id:"map",zoom:16,centerOn:"shape",center:{lat:39.952335,lng:-75.163789}},e),C,w,b=false;var c,r=q.zoom,t,x,p,y,l={bus:{width:32,height:37,path:"/images/markers/bus.png"},user:{width:24,height:24,path:"/images/gentleface/black/pin_map_icon&24.png"}};var j;var s=false;function o(){if(x&&p){var D=L.latLng(p.lat,p.lon),F=L.latLng(x.lat,x.lng),E=new L.LatLngBounds();E.extend(D);E.extend(F);if(s){setTimeout(function(){c.fitBounds(E);s=false},500)}else{c.fitBounds(E)}}else{if(x){s=true;setTimeout(function(){if(!p){B(x.lng,x.lat)}},500)}else{if(p){s=true;setTimeout(function(){if(!x){B(p.lon,p.lat)}},500)}}}}function m(){u(p.lon,p.lat,null,"user");if(q.centerOn==="user"){o()}}function h(){var D="",F=parseInt(x.offset,10);if(!isNaN(F)){D=F+" min"+(F==1?"":"s")+" ago"}if(p){u(p.lon,p.lat,null,"user")}if(t){var E=t.getLatLng();if(E.lat!==x.lat&&E.lng!==x.lng){_vehicleLocated=false;d(x.lng,x.lat,t,D)}}else{u(x.lng,x.lat,D)}o()}function A(E,D){$.each(D,function(H,J){if(J.route_id===E){var I=parseInt(J.offset,10),F=parseInt(J.late,10),G=J.mode==="rail"?(F+" min"+(F===1?"":"s")+"  late"):(I+" min"+(I==1?"":"s")+" ago");u(J.lng,J.lat,G)}})}function k(D){var E=w.routeId;a.Data.get("/locations/"+E,function(G){var F={};if(G.vehicles){$.each(G.vehicles,function(I,H){F[H.vehicle_id]=H})}if(D){if(D in F){x=F[D];x.lat=parseFloat(x.lat);x.lng=parseFloat(x.lng);h();setTimeout(function(){k(D)},60000)}else{}}else{A(E,G.vehicles)}})}function v(D,E){D.unbindPopup();D.bindPopup(E,{offset:L.point(57,10),closeButton:false,className:"ns-map-markerinfo s-corner-all-4"});D.openPopup()}function u(D,J,I,H){var F=l[H||"bus"],G=L.icon({iconUrl:F.path,iconSize:[F.width,F.height]});var E=L.marker([J,D],{icon:G,title:I||""}).addTo(c);if(H!=="user"){t=E}if(I){v(E,I)}}function d(D,G,E,F){E.setLatLng([G,D]);if(F){v(E,F)}}function B(D,F,E){E=E||r;c.setView([F,D],E)}function z(){var D=$("#"+q.id+"-shape").html();if(D){D=JSON.parse(D);if(D&&D.coordinates&&D.coordinates.length){y=L.geoJson(D,{style:function(){return{color:"#a33",opacity:0.8}}}).addTo(c);if(q.centerOn==="shape"){c.fitBounds(y.getBounds())}}}}function n(){var D=$(window).height()-$("#header").outerHeight();$("#"+q.id+"-inner").height(D)}function g(){var E=j.attr("data-route"),D=j.attr("data-bus");n();c=L.map(q.id+"-inner");wax.tilejson("http://api.tiles.mapbox.com/v3/reedlauber.map-55lsrr7u.jsonp",function(F){c.addLayer(new wax.leaf.connector(F));z();k(D);if(!y||q.centerOn!="shape"){B(q.center.lng,q.center.lat,12)}if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(G){p={lat:G.coords.latitude,lon:G.coords.longitude};m()})}});b=true}f.init=function(D,E){C=D;w=E;j=$("#"+q.id);if(j.is(":visible")){g()}return f};return f}})(NextSepta);